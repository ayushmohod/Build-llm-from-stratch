

#include <stdio.h>
#include <gmp.h>

int main() {
    mpz_t num1, num2, sum;

    // Initialize the GMP variables
    mpz_init(num1);
    mpz_init(num2);
    mpz_init(sum);

    // Assign values to the GMP variables
    mpz_set_str(num1, "1234567890123456789012345678901234567890", 10);
    mpz_set_str(num2, "9876543210987654321098765432109876543210", 10);

    // Add the two numbers
    mpz_add(sum, num1, num2);

    // Print the result
    printf("num1 = ");
    mpz_out_str(stdout, 10, num1);
    printf("\n");

    printf("num2 = ");
    mpz_out_str(stdout, 10, num2);
    printf("\n");

    printf("sum  = ");
    mpz_out_str(stdout, 10, sum);
    printf("\n");

    // Clear the GMP variables
    mpz_clear(num1);
    mpz_clear(num2);
    mpz_clear(sum);

    return 0;
}
















#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <stdint.h>

#define MAX_N 1024

int64_t floor12(double x) {
    int64_t xi = (int64_t)x;
    return x < xi ? xi - 1 : xi;
}
uint64_t log23(uint64_t x) {
      uint64_t res = 0;
      while (x >>= 1) {
      res++;
      }
      return res;
}

int64_t pos_mod(int64_t x, int64_t m) {
    if (m == 0) {
        return 0; 
    }
    int64_t mod = x % m;
    if ((mod < 0 && m > 0) || (mod > 0 && m < 0)) {
        return mod + m;
    }
    return mod;
}

uint64_t modpow(uint64_t base, uint64_t exp, uint64_t mod) {
    uint64_t result = 1;
    base = pos_mod(base,mod);
    while (exp > 0) {
        if (exp & 1) {
            result = pos_mod((result * base), mod);
        }
        base = pos_mod((base * base), mod);
        exp >>= 1;
    }
    return result;
}

void RefPolMulv2(int64_t *A, int64_t *B, int64_t *C, int64_t *D) {
  for (uint64_t i = 0; i < 2 * MAX_N; i++) {
    C[i] = 0;
  }
  for (uint64_t i = 0; i <  MAX_N; i++) {
    D[i] = 0;
  }
  for (uint64_t i = 0; i < MAX_N; i++) {
    for (uint64_t j = 0; j < MAX_N; j++) {
      C[i + j] = (C[i + j] + A[i] * B[j]);
    }
  }
  for (uint64_t i = 0; i < MAX_N; i++) {
    D[i] = (C[i] - C[i + MAX_N]);
  }
}

void egcd(int64_t a, int64_t b, int64_t *g, int64_t *x, int64_t *y) {
  if (a == 0) {
    *g = b;
    *x = 0;
    *y = 1;
  } else {
    int64_t g_, x_, y_;
    egcd(pos_mod(b , a), a, &g_, &y_, &x_);
    *g = g_;
    *x = x_ - (b / a) * y_;
    *y = y_;
  }
}

int64_t modinv(int64_t a, int64_t m) {
  int64_t g, x, y;
  egcd(a, m, &g, &x, &y);
  return pos_mod((pos_mod(x, m) + m), m);
}

uint64_t intReverse(uint64_t a, uint64_t n) {
  uint64_t b = 0;
  for (uint64_t i = 0; i < n; i++) {
    b = (b << 1) | (a & 1);
    a >>= 1;
  }
  return b;
}

void indexReverse(int64_t *a, int64_t *b, uint64_t n, uint64_t r) {
  for (uint64_t i = 0; i < n; i++) {
    uint64_t rev_idx = intReverse(i, r);
    b[rev_idx] = a[i];
  }
}

void NTT(int64_t *A, int64_t *B, int64_t *W_table, int64_t q, uint64_t n) {
  for (uint64_t i = 0; i < n; i++) {
    B[i] = A[i];
  }
  uint64_t v = (uint64_t)log23(n);
  for (uint64_t i = 0; i < v; i++) {
    for (uint64_t j = 0; j < (1 << i); j++) {
      for (uint64_t k = 0; k < (1 << (v - i - 1)); k++) {
        uint64_t s = j * (1 << (v - i)) + k;
        uint64_t t = s + (1 << (v - i - 1));
        int64_t w = W_table[(1 << i) * k];
        int64_t as_temp = B[s];
        int64_t at_temp = B[t];
        B[s] = pos_mod((as_temp + at_temp), q);
        B[t] = pos_mod(((as_temp - at_temp + q) * w), q);
      }
    }
  }
  int64_t rev_B[n];
  indexReverse(B, rev_B, n, v);
  for (uint64_t i = 0; i < n; i++) {
    B[i] = rev_B[i];
  }
}

void INTT(int64_t *A, int64_t *B, int64_t *W_table, int64_t q, uint64_t n) {
  for (uint64_t i = 0; i < n; i++) {
    B[i] = A[i];
  }
  uint64_t v = (uint64_t)log23(n);
  for (uint64_t i = 0; i < v; i++) {
    for (uint64_t j = 0; j < (1 << i); j++) {
      for (uint64_t k = 0; k < (1 << (v - i - 1)); k++) {
        uint64_t s = j * (1 << (v - i)) + k;
        uint64_t t = s + (1 << (v - i - 1));
        int64_t w = W_table[(1 << i) * k];
        int64_t as_temp = B[s];
        int64_t at_temp = B[t];
        B[s] = pos_mod((as_temp + at_temp), q);
        B[t] = pos_mod(((as_temp - at_temp + q) * w), q);
      }
    }
  }
  int64_t rev_B[n];
  indexReverse(B, rev_B, n, v);
  for (uint64_t i = 0; i < n; i++) {
    B[i] = rev_B[i];
  }
  int64_t n_inv = modinv(n, q);
  for (uint64_t i = 0; i < n; i++) {
    B[i] = pos_mod((B[i] * n_inv), q);
  }
}

typedef struct {
  uint64_t n;
  int64_t q;
  int64_t *np;
  int64_t F[MAX_N];
  int inNTT;
} Poly;



void poly_init(Poly *p, uint64_t n, int64_t q, int64_t *np) {
  p->n = n;
  p->q = q;
  p->np = np;
  for (uint64_t i = 0; i < n; i++) {
    p->F[i] = 0;
  }
  p->inNTT = 0;
}

// void poly_randomize(Poly *p, int64_t B, int domain, int type, int64_t mu, int64_t sigma) {
//     for (uint64_t i = 0; i < p->n; i++) {
//         // int64_t randomValue = (pos_mod(rand(), (B + 1)) - B / 2);
//         // p->F[i] = pos_mod(((pos_mod(randomValue, p->q)) + p->q), p->q);  // Ensures a non-negative result
//         int64_t randomValue = (rand() % (B + 1)) - B / 2;
//         p->F[i] = (randomValue + p->q) % p->q;  // Ensures a non-negative result
//     }
//     p->inNTT = domain;
// }


void poly_add(Poly *a, Poly *b, Poly *c) {
  for (uint64_t i = 0; i < a->n; i++) {
    c->F[i] = pos_mod((a->F[i] + b->F[i]), a->q);
  }
  c->inNTT = a->inNTT;
}

void poly_sub(Poly *a, Poly *b, Poly *c) {
  for (uint64_t i = 0; i < a->n; i++) {
    c->F[i] = pos_mod((a->F[i] - b->F[i] + a->q), a->q);
  }
  c->inNTT = a->inNTT;
}



void poly_mul(Poly *a, Poly *b, Poly *c) {
    int64_t *w_table = a->np;
    int64_t *wv_table = a->np + a->n;
    int64_t *psi_table = a->np + 2 * a->n;
    int64_t *psiv_table = a->np + 3 * a->n;
    int64_t s_p[MAX_N], b_p[MAX_N], s_n[MAX_N], b_n[MAX_N], sb_n[MAX_N], sb_p[MAX_N];
    
    for (uint64_t i = 0; i < a->n; i++) {
        s_p[i] = pos_mod(a->F[i] * psi_table[i], a->q);
        b_p[i] = pos_mod(b->F[i] * psi_table[i], a->q);
    }
    
    NTT(s_p, s_n, w_table, a->q, a->n);
    NTT(b_p, b_n, w_table, a->q, a->n);
    
    for (uint64_t i = 0; i < a->n; i++) {
        sb_n[i] = pos_mod(s_n[i] * b_n[i], a->q);
    }
    
    INTT(sb_n, sb_p, wv_table, a->q, a->n);
    
    for (uint64_t i = 0; i < a->n; i++) {
        c->F[i] = pos_mod(sb_p[i] * psiv_table[i], a->q);
    }
    
    c->inNTT = 0;
}

void poly_mod(Poly *a, int64_t base, Poly *b) {
  for (uint64_t i = 0; i < a->n; i++) {
    b->F[i] = pos_mod(a->F[i] , base);
  }
  b->inNTT = a->inNTT;
}

int64_t python_round(double x) {
    int64_t rounded = (int64_t)floor12(x + 0.5);
    if (fabs(x - rounded) == 0.5) {
        if (rounded % 2 != 0) {
            rounded--;
        }
    }
    return rounded;
}

void poly_neg(Poly *a, Poly *b) {
  for (uint64_t i = 0; i < a->n; i++) {
    b->F[i] = pos_mod((a->q - a->F[i]), a->q);
  }
  b->inNTT = a->inNTT;
}

typedef struct {
  uint64_t n;
  int64_t q;
  int64_t t;
  int64_t T;
  int64_t l;
  int64_t mu;
  int64_t sigma;
  int64_t *qnp;
  Poly sk;
  Poly pk[2];
  Poly rlk1[11][2];
} BFV;

void bfv_init(BFV *bfv, uint64_t n, int64_t q, int64_t t, int64_t mu, int64_t sigma, int64_t *qnp) {
  bfv->n = n;
  bfv->q = q;
  bfv->t = t;
  bfv->T = 0;
  bfv->l = 0;
  bfv->mu = mu;
  bfv->sigma = sigma;
  bfv->qnp = qnp;
  poly_init(&bfv->sk, n, q, qnp);
  for (int i = 0; i < 2; i++) {
    poly_init(&bfv->pk[i], n, q, qnp);
  }
  for (int i = 0; i < 4; i++) {
    for (int j = 0; j < 2; j++) {
      poly_init(&bfv->rlk1[i][j], n, q, qnp);
    }
  }
}

void bfv_secret_key_gen(BFV *bfv) {
    int64_t sk[]= {132120576, 1, 0, 1, 1, 0, 1, 0, 0, 132120576, 1, 132120576, 132120576, 132120576, 132120576, 132120576, 0, 132120576, 1, 1, 0, 132120576, 132120576, 1, 132120576, 132120576, 1, 0, 132120576, 132120576, 1, 1, 132120576, 132120576, 1, 0, 0, 0, 132120576, 132120576, 1, 0, 1, 132120576, 132120576, 0, 1, 1, 1, 0, 132120576, 132120576, 132120576, 0, 1, 0, 132120576, 0, 132120576, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 132120576, 1, 0, 0, 0, 1, 132120576, 0, 132120576, 0, 1, 0, 0, 132120576, 0, 1, 0, 0, 1, 132120576, 132120576, 1, 1, 132120576, 0, 132120576, 1, 1, 1, 132120576, 132120576, 132120576, 1, 1, 132120576, 1, 132120576, 132120576, 132120576, 1, 0, 132120576, 1, 0, 1, 132120576, 132120576, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 132120576, 132120576, 132120576, 0, 132120576, 1, 0, 1, 1, 132120576, 0, 132120576, 1, 0, 132120576, 0, 0, 1, 1, 1, 0, 132120576, 132120576, 0, 1, 0, 0, 1, 132120576, 132120576, 0, 132120576, 0, 132120576, 0, 1, 0, 132120576, 132120576, 0, 0, 0, 132120576, 132120576, 132120576, 1, 0, 0, 132120576, 1, 1, 0, 0, 132120576, 1, 1, 1, 132120576, 0, 1, 1, 132120576, 1, 1, 132120576, 0, 1, 1, 1, 0, 1, 132120576, 132120576, 132120576, 132120576, 0, 1, 132120576, 1, 132120576, 1, 1, 1, 1, 0, 132120576, 0, 0, 132120576, 0, 1, 132120576, 132120576, 1, 0, 1, 0, 132120576, 0, 0, 1, 132120576, 132120576, 132120576, 1, 132120576, 132120576, 1, 0, 1, 132120576, 132120576, 132120576, 1, 132120576, 1, 132120576, 1, 1, 0, 132120576, 132120576, 132120576, 132120576, 1, 1, 1, 132120576, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 132120576, 0, 132120576, 132120576, 1, 132120576, 1, 132120576, 0, 1, 1, 1, 132120576, 1, 0, 1, 1, 1, 1, 1, 132120576, 0, 1, 0, 1, 0, 132120576, 1, 0, 0, 0, 1, 132120576, 1, 1, 0, 1, 132120576, 1, 1, 1, 132120576, 1, 132120576, 132120576, 132120576, 132120576, 132120576, 1, 132120576, 0, 132120576, 0, 1, 0, 0, 0, 0, 0, 1, 0, 132120576, 0, 1, 1, 1, 132120576, 0, 132120576, 132120576, 0, 1, 1, 132120576, 132120576, 1, 1, 1, 132120576, 132120576, 132120576, 132120576, 1, 1, 0, 132120576, 132120576, 0, 132120576, 132120576, 1, 0, 0, 0, 132120576, 1, 132120576, 132120576, 1, 132120576, 0, 1, 0, 0, 0, 1, 1, 0, 132120576, 1, 132120576, 1, 132120576, 1, 132120576, 1, 1, 1, 132120576, 132120576, 0, 132120576, 1, 1, 1, 132120576, 0, 132120576, 132120576, 1, 1, 132120576, 132120576, 1, 0, 0, 132120576, 0, 132120576, 1, 0, 132120576, 1, 0, 132120576, 0, 132120576, 0, 1, 132120576, 0, 0, 0, 0, 132120576, 1, 0, 132120576, 1, 1, 0, 1, 0, 132120576, 1, 132120576, 0, 132120576, 1, 0, 1, 132120576, 1, 132120576, 0, 0, 1, 1, 1, 132120576, 0, 132120576, 1, 0, 132120576, 0, 1, 0, 132120576, 1, 1, 0, 132120576, 132120576, 1, 0, 1, 132120576, 1, 1, 1, 1, 1, 0, 1, 1, 132120576, 132120576, 1, 132120576, 1, 1, 132120576, 0, 0, 0, 0, 132120576, 132120576, 132120576, 0, 0, 1, 132120576, 1, 0, 1, 1, 1, 132120576, 132120576, 0, 0, 132120576, 0, 0, 132120576, 0, 1, 0, 0, 0, 1, 0, 132120576, 0, 132120576, 132120576, 1, 1, 132120576, 132120576, 0, 0, 1, 0, 1, 1, 132120576, 132120576, 0, 0, 132120576, 0, 1, 0, 1, 0, 132120576, 132120576, 132120576, 1, 1, 1, 132120576, 0, 132120576, 1, 132120576, 0, 0, 1, 132120576, 132120576, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 132120576, 1, 0, 1, 132120576, 1, 0, 1, 132120576, 0, 1, 0, 1, 1, 0, 132120576, 0, 1, 132120576, 1, 0, 132120576, 132120576, 0, 132120576, 132120576, 132120576, 0, 132120576, 0, 0, 132120576, 0, 0, 1, 132120576, 1, 0, 1, 0, 0, 0, 132120576, 1, 132120576, 1, 132120576, 132120576, 132120576, 1, 132120576, 0, 0, 0, 132120576, 0, 1, 1, 1, 132120576, 1, 0, 0, 1, 132120576, 0, 0, 0, 132120576, 0, 0, 0, 132120576, 1, 1, 1, 1, 132120576, 1, 1, 0, 0, 1, 1, 132120576, 0, 132120576, 0, 0, 1, 1, 132120576, 132120576, 132120576, 0, 132120576, 0, 1, 132120576, 0, 0, 132120576, 1, 1, 1, 1, 132120576, 1, 0, 132120576, 0, 132120576, 0, 132120576, 132120576, 132120576, 0, 0, 132120576, 0, 132120576, 0, 1, 1, 1, 1, 132120576, 132120576, 0, 132120576, 0, 1, 0, 0, 0, 1, 132120576, 0, 1, 1, 0, 132120576, 132120576, 132120576, 0, 132120576, 132120576, 132120576, 132120576, 132120576, 132120576, 132120576, 1, 1, 132120576, 0, 0, 132120576, 1, 132120576, 1, 132120576, 0, 0, 0, 1, 1, 0, 132120576, 132120576, 0, 0, 1, 132120576, 132120576, 1, 132120576, 132120576, 132120576, 132120576, 1, 0, 1, 1, 132120576, 0, 0, 0, 132120576, 0, 1, 132120576, 132120576, 0, 0, 132120576, 132120576, 132120576, 132120576, 1, 1, 0, 132120576, 1, 132120576, 1, 0, 0, 1, 0, 0, 132120576, 132120576, 1, 132120576, 132120576, 1, 132120576, 1, 0, 0, 1, 132120576, 0, 132120576, 132120576, 132120576, 0, 1, 0, 132120576, 132120576, 1, 132120576, 0, 0, 0, 132120576, 0, 1, 132120576, 132120576, 132120576, 0, 132120576, 1, 132120576, 0, 1, 0, 0, 1, 132120576, 132120576, 132120576, 1, 0, 0, 1, 132120576, 0, 0, 1, 1, 1, 1, 132120576, 132120576, 0, 0, 132120576, 132120576, 132120576, 0, 0, 0, 0, 132120576, 132120576, 1, 132120576, 132120576, 1, 132120576, 0, 132120576, 1, 0, 0, 132120576, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 132120576, 0, 1, 132120576, 0, 0, 132120576, 132120576, 132120576, 0, 132120576, 132120576, 1, 132120576, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 1, 132120576, 0, 132120576, 1, 0, 1, 0, 0, 132120576, 0, 1, 132120576, 132120576, 1, 132120576, 1, 0, 1, 132120576, 1, 1, 1, 132120576, 1, 1, 1, 0, 132120576, 0, 0, 132120576, 132120576, 0, 132120576, 132120576, 1, 132120576, 132120576, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 132120576, 1, 132120576, 132120576, 1, 132120576, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 132120576, 132120576, 0, 1, 132120576, 0, 132120576, 0, 132120576, 132120576, 1, 132120576, 1, 1, 132120576, 0, 132120576, 0, 0, 0, 1, 132120576, 1, 1, 0, 132120576, 1, 0, 1, 1, 0, 0, 1, 1, 1, 132120576, 132120576, 132120576, 132120576, 132120576, 132120576, 1, 132120576, 1, 1, 0, 1, 132120576, 1, 0, 0, 1, 0, 0, 0, 0, 132120576, 1, 1, 0};

        for(int i=0;i<1024;i++){
        bfv->sk.F[i]=sk[i];
    }

    //   poly_randomize(&bfv->sk, 2, 0, 0, 0, 0);

}

void bfv_public_key_gen(BFV *bfv) {
  Poly a, e;
  poly_init(&a, bfv->n, bfv->q, bfv->qnp);
  poly_init(&e, bfv->n, bfv->q, bfv->qnp);
//   poly_randomize(&a, bfv->q, 0, 0, 0, 0);

//   poly_randomize(&e, 0, 0, 1, bfv->mu, bfv->sigma);

   int64_t avalue[]= {114932524, 104519866, 18839563, 4444179, 75956437, 88942410, 11597465, 20300106, 4441968, 114432013, 117796358, 13614742, 50529853, 129791172, 22731022, 64125356, 77445722, 121273312, 32673323, 34858235, 21761829, 13407045, 75410322, 3219069, 37657890, 53105050, 131553068, 101003993, 120000379, 115568700, 72286329, 123382751, 62667335, 76503281, 60693319, 48380142, 123040342, 54461191, 49213022, 131384071, 20366211, 101287409, 57683054, 101897652, 101480695, 126294492, 100118308, 70572180, 14113938, 122147350, 18535231, 100564084, 9618589, 14870016, 97238513, 114741602, 35802664, 45016708, 87526006, 92978304, 122204219, 64420781, 62142827, 104142701, 91864323, 67071444, 67372769, 127440170, 38184188, 115885300, 21453175, 85275715, 110992216, 37336762, 85773306, 55086644, 23379905, 96349518, 97831897, 106157388, 59887813, 76422617, 64545565, 61261928, 70157118, 52336921, 62685630, 100747657, 77404665, 20902948, 44139317, 61046985, 68036718, 117783519, 102725433, 125507635, 69901451, 58103810, 9972037, 126672341, 20415565, 55595588, 56155709, 34760887, 82622243, 126559526, 32926542, 56032852, 57605521, 96073309, 129374568, 66745437, 97020051, 64178090, 4350528, 7711653, 67535332, 88572536, 21329908, 43762146, 122126872, 16883415, 10520175, 5658371, 86652796, 31912995, 124136138, 120712995, 124461768, 106372517, 39388570, 112386394, 129658814, 97056463, 55025872, 12272014, 49295, 89230602, 56595900, 12701807, 92435983, 110459457, 105185158, 24087285, 51358599, 76065694, 36968657, 23700757, 81831593, 79358099, 37817567, 102238904, 43177003, 60828837, 86655442, 69237791, 51358071, 50040848, 35165217, 23863883, 124290580, 41439450, 4534170, 18801964, 8802707, 76590440, 92701664, 14963801, 24308825, 124429773, 27873520, 46150140, 114754643, 5348256, 91567982, 79008174, 76371491, 21935884, 25199584, 75784972, 117557765, 93334926, 53773656, 46281200, 94712032, 61989709, 62927509, 96492569, 84008933, 119123989, 51987977, 26544897, 105745113, 64033206, 87930875, 61522166, 42382434, 61687432, 4323804, 49812081, 76591881, 7080776, 116244235, 24280306, 12527384, 84411135, 59389255, 119225225, 21216752, 96994709, 78601695, 93781588, 105345253, 11063895, 117154367, 25308547, 81776299, 82568436, 22066175, 67969221, 87992221, 9722356, 35511902, 12155028, 64275370, 112529191, 82231439, 99783637, 9209177, 49788782, 119900292, 86757417, 115320366, 33004845, 128060887, 11087277, 2213606, 47563088, 39600760, 20093422, 104244918, 57351701, 22722350, 52808800, 108116196, 106192040, 105419259, 117229389, 59133124, 54211466, 48143500, 32176676, 109520512, 430134, 51713757, 16134643, 118987527, 35196795, 24638682, 348899, 78337816, 58228836, 11190550, 12889421, 76412677, 5348962, 108084193, 109103659, 82452961, 89489949, 30614951, 65019459, 130420764, 29444403, 37742829, 10038261, 88369539, 34442987, 76441203, 70142337, 123081973, 31885955, 120043041, 28234065, 10151863, 105761010, 23005521, 80185963, 131522114, 111079021, 14167028, 122957636, 70035136, 20130778, 1501775, 31607719, 104821335, 23537667, 121824652, 52188527, 63416186, 126506293, 27944180, 50866223, 111322222, 55028206, 52764696, 103849196, 11517215, 10355438, 117067005, 47047677, 125207743, 50008454, 45608662, 72114849, 46336527, 15450125, 92246690, 40823915, 104701179, 72565270, 101000616, 110572174, 123940862, 93203146, 23578551, 129931244, 70864050, 107724493, 116676649, 126877871, 101070162, 66108983, 53044026, 20883571, 49091340, 103600285, 115433523, 17009607, 88992614, 44397544, 130512006, 68625930, 14820729, 109007514, 126459405, 44715573, 16854641, 92583129, 113283868, 49461876, 96491629, 37470968, 14566771, 42170199, 127378303, 79696318, 127863119, 44737911, 3174878, 105191392, 32720342, 47991069, 24485885, 9357103, 97869346, 63818018, 61131381, 18397047, 123979979, 8804199, 69450608, 110914093, 58485685, 55708158, 114421025, 29872158, 77585674, 94463479, 70161735, 119095701, 103488700, 39755536, 110678730, 104190328, 86248075, 99150275, 41008281, 104156582, 105779161, 12832928, 21891912, 93223639, 121643715, 86775370, 68374474, 73171765, 105528043, 45089338, 31856874, 66561828, 52096508, 12702340, 16982460, 54568337, 32599334, 68728076, 68127631, 97838583, 119755137, 63938867, 55233856, 46115261, 65674143, 75503719, 95064885, 57443595, 104289091, 121457683, 97056975, 57548357, 23095030, 41409454, 38149826, 28020584, 60289630, 130462439, 58675404, 95485492, 96214828, 49862594, 6930959, 38034790, 75313479, 53933939, 59286728, 26536488, 42150628, 23871242, 60930563, 55934229, 52196283, 45789775, 115409830, 101653574, 123709083, 93896778, 16977940, 50857636, 87320666, 83584972, 129558244, 17136033, 11913870, 66693062, 36492202, 71239483, 119899617, 116624442, 61617695, 70097008, 106405738, 111762248, 10505962, 22587535, 4912836, 29076383, 26377479, 470462, 78021033, 97290792, 115210184, 88096922, 123091596, 9772405, 42941525, 11151123, 23268412, 21370233, 57749897, 79670046, 90690298, 37574495, 81867671, 74348001, 30333299, 40111110, 12855784, 73294773, 43315908, 55971352, 79935195, 21224103, 45897155, 83658786, 112238862, 114545156, 30143208, 43940481, 28174241, 111740067, 40042133, 113654511, 113723765, 25849933, 41557111, 63918004, 32062002, 23892285, 54925820, 91881023, 70685383, 88528504, 75056177, 19013408, 126307593, 41460014, 4316701, 29585147, 106023230, 113977185, 104650462, 123418756, 59767490, 27168469, 81241571, 1851835, 7963507, 111602312, 74058442, 27038892, 3335895, 9228134, 129440791, 130393947, 85498813, 119561245, 39442230, 37197500, 42001206, 20487683, 1793811, 97219092, 80995881, 108746981, 12015159, 42438336, 93538023, 71259109, 66359947, 32624987, 93722403, 12745414, 32858882, 111132587, 90564874, 1561975, 109836326, 76324284, 64531497, 65654295, 108942877, 49867586, 103086149, 126940900, 66088718, 69532779, 98674841, 107789087, 70984511, 101367099, 119292097, 84710347, 10235036, 72831954, 70728041, 41516126, 7709596, 91714653, 19456180, 32847382, 74461187, 53676978, 93041483, 52665650, 120840694, 34046797, 4455482, 60030295, 63873246, 46957425, 62008041, 86705655, 45648293, 62612957, 82186125, 23759748, 76626605, 70679042, 70883009, 11371369, 122686380, 2538620, 112038582, 56771710, 59361296, 54675947, 110429404, 1527817, 14373638, 39827606, 109582222, 103263142, 32277053, 98588906, 27509929, 91481931, 85787874, 88302820, 130294669, 90298967, 41583337, 105340991, 43463761, 100354779, 29959796, 38247463, 52946976, 95225246, 17886669, 123424877, 42003829, 96052852, 86327529, 61468287, 15830065, 62736337, 48533253, 114575734, 96384656, 106387344, 55619411, 16848819, 5900067, 103063031, 47560864, 44015900, 71634203, 52537769, 79023020, 100408689, 97439089, 2417765, 132100925, 29512112, 107221190, 73472137, 104079577, 8536440, 109892438, 108505615, 51395440, 123706408, 85875304, 64528246, 13929260, 38704300, 11937657, 126663138, 16501845, 69238271, 105015894, 10525338, 94891307, 36125542, 77854653, 117553031, 107421637, 59493317, 91215419, 1055947, 54667366, 78892598, 78426386, 75270257, 8130990, 56556396, 23295270, 124537952, 131308774, 81881610, 91864731, 31320448, 53115498, 81994425, 27560448, 102833503, 31759521, 129080481, 116930016, 79467324, 125671383, 119099530, 13065544, 124601895, 93445941, 111203518, 67305878, 99322320, 85975509, 104925255, 26692951, 97893072, 61697073, 41783640, 124752255, 41534287, 130382274, 128902500, 61766656, 38275271, 74154154, 120126677, 27193908, 62464175, 101254286, 3945759, 69817744, 6570556, 67859086, 14110861, 126466415, 108622804, 69802429, 65191220, 109945097, 78890039, 105031332, 69251161, 19385789, 94910930, 35808198, 44870197, 19074066, 94948654, 125224795, 120370263, 58260677, 39367761, 68847880, 8517191, 100989414, 78185355, 47666919, 123995598, 82359124, 101907555, 90706828, 99422241, 49351574, 71621997, 36403512, 59131269, 38349898, 79192658, 22650043, 15296139, 20023794, 29156200, 121441729, 83374346, 106090983, 10265869, 46277915, 26394911, 89587033, 109250818, 101728227, 9528727, 76652985, 58684341, 121691260, 27878574, 47793919, 60313461, 73357830, 87103764, 68079106, 104107802, 91932936, 35609956, 73426038, 15482557, 125050106, 21848567, 23852600, 96749016, 11471660, 121682262, 32426937, 30294935, 93277257, 118988832, 101748190, 99770587, 14223207, 42589551, 85186854, 101069693, 117767678, 43556634, 115699059, 97103751, 77566236, 14429718, 32111979, 108549148, 31041041, 11817969, 24351123, 50110216, 55441808, 18097819, 122011187, 84760450, 16631886, 20182467, 24312691, 88067770, 124745337, 48970226, 29619943, 110029029, 93783879, 96394095, 57416304, 80782258, 34372646, 30724336, 22290785, 49680971, 6643635, 31577721, 16018983, 128916506, 93022930, 32837825, 58124510, 49779062, 86832831, 18412555, 90688738, 93576127, 76537731, 77831828, 53293564, 123292968, 121583587, 76274859, 102389298, 17166726, 10895987, 9664104, 127359855, 24691913, 109377616, 53115468, 9717396, 6152489, 84390386, 37756193, 30220519, 93760418, 4421068, 35348008, 54224351, 106392260, 49323694, 50976989, 185354, 126804027, 115227924, 54904395, 131294728, 121204073, 107509600, 126415994, 99812644, 49612451, 110162532, 7457832, 111171234, 28971735, 39379221, 107285313, 23115317, 95422249, 79483393, 25679442, 109138820, 82989655, 77514030, 9032930, 85169284, 107380197, 105866599, 86929210, 112706954, 118678772, 36548180, 37960421, 67085263, 97710287, 83333973, 107949188, 4605441, 17782331, 14663589, 27011259, 107446043, 34848974, 59414735, 38500125, 65864141, 7233073, 83962004, 41579934, 102242796, 65223130, 129761818, 123926689, 110547535, 42613778, 131191077, 119545808, 72465873, 26675060, 29882807, 45740170, 87366088, 32588385, 54543398, 45414354, 23230568, 8888263, 103158764, 83282807, 44623255, 108429097, 43475809, 83093033, 113013250, 19755618, 65952273, 102344304, 2744986, 59605719, 122190915, 83781403, 15267502, 115215270, 61311629, 30921727, 110939434, 59286624, 101072107, 124034971, 130600653, 106849290, 126519506, 129405057, 99652650, 43259673, 45811909, 21119771, 94119529, 103177550, 82219339, 57106741, 114908134, 54117369, 28149649, 107538405, 13213605, 57229555, 51039020, 14557800, 37930076, 74847913, 120637585, 64743003, 27462822, 120783528, 120398476, 43354113, 31253458, 50088571, 100118914, 126869834, 93216575, 12318468, 57396209, 2897398, 29175655, 54458759, 109997782, 115646938, 122727907, 129202895, 63482972, 25696224, 88663616, 27023043, 103787724, 125749554, 97369539, 129779864, 35794930, 12011649, 114041019, 21122575, 66541359, 108319299};

   for(int i=0;i<1024;i++){
        a.F[i]=avalue[i];
   }

  Poly temp;
  poly_init(&temp, bfv->n, bfv->q, bfv->qnp);
  
  poly_mul(&a, &bfv->sk, &temp);
  poly_add(&temp, &e, &bfv->pk[0]);
  poly_neg(&bfv->pk[0], &bfv->pk[0]);
  poly_init(&bfv->pk[1], bfv->n, bfv->q, bfv->qnp);
  for (uint64_t i = 0; i < bfv->n; i++) {
    bfv->pk[1].F[i] = a.F[i];
  }
}

void bfv_eval_key_gen_v1(BFV *bfv, int64_t T) {
  bfv->T = T;
  bfv->l = (int64_t)floor12(log23(bfv->q) / log23(bfv->T));

  Poly sk2;
  poly_init(&sk2, bfv->n, bfv->q, bfv->qnp);

  poly_mul(&bfv->sk, &bfv->sk, &sk2);

  for (int64_t i = 0; i <= bfv->l; i++) {
    Poly ai, ei, Ts2;
    poly_init(&ai, bfv->n, bfv->q, bfv->qnp);
    poly_init(&ei, bfv->n, bfv->q, bfv->qnp);
    poly_init(&Ts2, bfv->n, bfv->q, bfv->qnp);
    // poly_randomize(&ai, bfv->q, 0, 0, 0, 0);
    // poly_randomize(&ei, 0, 0, 1, bfv->mu, bfv->sigma);

    printf("\n");
    if(i==0){
        int64_t aivalue[]={10942928, 18979251, 131308854, 95843420, 59548779, 15821880, 29598660, 113250295, 9101869, 3644704, 29711247, 12399530, 71835883, 105320531, 65020075, 32569076, 104626041, 21244481, 21991337, 19873127, 118532280, 122627700, 65238714, 59487779, 113693543, 65918655, 113339252, 44589735, 12268582, 90617439, 8058284, 68080370, 130054104, 121582929, 36770569, 28498652, 48697051, 70722072, 38758075, 9538834, 91051596, 35692135, 13135029, 49481391, 101654880, 109740416, 44003640, 120531338, 88661318, 73202875, 93502368, 109405664, 51894598, 26908815, 21217830, 79394778, 46118157, 21897968, 88358490, 88544833, 79185064, 96668653, 96101787, 44076655, 104451326, 20986672, 59485446, 73224340, 101257043, 32770742, 46744437, 45605781, 33140355, 62777910, 91235458, 62559932, 2700690, 52610885, 42497895, 128748556, 1988920, 21605733, 52473799, 76948579, 48309961, 49013994, 53537321, 119625883, 26930382, 89538882, 37137985, 71691924, 49627469, 7044326, 64337692, 35946117, 23162502, 106601800, 6617527, 1468089, 63526007, 81752952, 53647967, 127723226, 7137332, 55234244, 89651325, 64690957, 11091707, 15416355, 44085080, 118435250, 29514233, 87782992, 47964555, 129540590, 28252713, 85587231, 53642835, 33436085, 122726019, 112281655, 90496701, 15131417, 84808923, 86976227, 106687023, 104036624, 67502211, 126786994, 65401493, 127213927, 96938580, 72930774, 53932577, 116428236, 57743059, 113742728, 86166074, 104548457, 51132792, 24309513, 12849020, 129556951, 99316955, 42349582, 126395190, 20890511, 125618179, 33460371, 12594206, 82086672, 130643245, 98144493, 6294185, 108440505, 11491230, 47122758, 63736706, 84518218, 97413220, 116484336, 34850491, 101674393, 20410621, 66014600, 116936394, 50658787, 58507290, 21893149, 45677441, 19038981, 25648939, 113388971, 15366131, 8178134, 44443701, 79488292, 121813930, 61407877, 122629860, 34848868, 112443538, 118662536, 79349370, 38571258, 63326041, 2618759, 62604627, 90210865, 111454971, 63146032, 77529153, 100004444, 43817138, 80055160, 11980087, 57846600, 55447279, 32743680, 120755183, 40496491, 1750437, 94178040, 4540646, 88968868, 87236315, 58166909, 128165437, 33119821, 97093292, 115289965, 122116137, 40548256, 116773144, 105599151, 104655860, 110527770, 6126139, 123008152, 104628184, 31276526, 17326583, 112654879, 8685681, 3032393, 96978135, 58647174, 48697248, 36557312, 130204811, 21344680, 11499418, 20623336, 129745395, 130254681, 71888903, 97404153, 50091824, 3281695, 23879654, 8726682, 87487268, 113275386, 53331285, 7252479, 31057397, 32265651, 113115566, 51579485, 108480054, 28879875, 11053266, 3287809, 87430301, 112147872, 43765942, 83798483, 36993393, 36539142, 38925273, 106577495, 22475549, 26491649, 103866753, 31543308, 12379272, 105995311, 46978292, 18593355, 97997256, 71304896, 1619637, 113747921, 119723894, 62782253, 41625090, 90516161, 3120966, 83494752, 63239991, 81724687, 73403564, 67921532, 41869113, 54409264, 121638018, 6395171, 96003890, 48329106, 85136773, 89575547, 9450055, 70693308, 89617222, 104322632, 50262990, 24186792, 77424785, 53596372, 14195408, 65496293, 114423039, 24165643, 84856795, 81642152, 29187695, 36174818, 44995046, 36055223, 126403830, 52825617, 100937512, 7197029, 122470021, 54297887, 101625567, 17516422, 7155585, 104306636, 42304629, 92618194, 67563111, 90551131, 98889195, 52489843, 4410886, 61640691, 96321768, 129451641, 19308383, 127607379, 14235567, 1216755, 90874948, 22027394, 632181, 60797337, 109365022, 51854591, 4182370, 128607914, 86639433, 1873754, 16267664, 9696956, 26390104, 93647052, 69528924, 6350300, 115289988, 5183316, 53315434, 85561275, 105409957, 125804359, 8609785, 29227031, 102856893, 63206009, 13066901, 130313720, 16279240, 105400931, 48535369, 23778550, 111696718, 44839728, 32613412, 107866810, 42535618, 123705700, 39068656, 111719225, 26727936, 48070408, 130496554, 2972324, 125524801, 126163492, 110815065, 39200039, 17883207, 82117214, 33804561, 24405678, 130672304, 96678318, 59155892, 73796187, 23510273, 81051402, 87260975, 33265232, 84224157, 97152672, 61128986, 86859273, 21317760, 68231777, 53862170, 110282285, 65268426, 10993630, 74741270, 37600532, 10367058, 78340285, 127037353, 105040726, 32040928, 13545542, 82452499, 99304324, 45187811, 60868843, 74728046, 86395861, 17273929, 72931721, 12224955, 64588932, 74818918, 76607546, 77470326, 15743971, 4571502, 3124144, 101302556, 53094926, 81029915, 42619547, 73638416, 77636428, 32515961, 23505413, 88731633, 35479726, 106789997, 61209032, 120096106, 40222567, 82660492, 77516935, 112416294, 68030581, 98832109, 131895240, 92198771, 76572828, 25924485, 65184407, 91797877, 41629831, 117271, 41402000, 4170664, 58508741, 65937216, 47660423, 29095303, 118435932, 91339672, 94958539, 101011416, 45098825, 61890916, 49410474, 68928216, 16454420, 8740786, 38984569, 38972684, 125503919, 72770837, 92350333, 34445291, 94698475, 31749092, 77491373, 97673827, 54855138, 35771343, 89894401, 1651253, 31294654, 93114813, 21532619, 39956671, 111901718, 130365474, 124797282, 36580193, 72128586, 76168944, 27311311, 4591776, 29078778, 115402727, 112324077, 79835286, 51480497, 21711666, 77335745, 7690102, 11200114, 105887160, 96556021, 21129272, 9955602, 90923358, 130001480, 117566285, 97491837, 132068754, 105721241, 101021399, 82935689, 123435257, 40498440, 33633354, 26344181, 121097032, 18106210, 85877689, 60512988, 47843906, 101883480, 63216706, 35943233, 115026321, 11948372, 82209754, 66799470, 93360700, 126535909, 90135039, 31206555, 103702875, 83435703, 42546842, 74413123, 46153893, 63022116, 4153773, 123213555, 93481053, 96836094, 117789313, 101692719, 700166, 2464214, 42265535, 81355138, 87999910, 60582754, 71887835, 121353811, 116151875, 113624796, 47511313, 81570179, 102573700, 51185607, 93796287, 58917241, 74675337, 61817628, 21374805, 86829927, 107838867, 129891782, 44824837, 115394507, 32681865, 130052928, 100185105, 127499675, 73058548, 96546447, 59960945, 124128043, 115687766, 3675923, 53550244, 121550599, 31691530, 55509578, 95826333, 10746525, 78592910, 32052022, 62061783, 65477934, 90370053, 114972684, 93035445, 43978751, 81339264, 72781687, 39812721, 91021389, 108571309, 113988649, 130336436, 114740767, 14916617, 16067340, 67997100, 69798223, 29199118, 126755982, 66531149, 75424888, 2813838, 52639704, 78302503, 129930875, 17830346, 92419168, 106720020, 97480473, 57457860, 76672358, 123485512, 80888017, 11335054, 110657110, 17516755, 70091687, 47562547, 70952279, 129443509, 30774408, 88809538, 12011746, 104323863, 42464160, 9208922, 110669003, 114161953, 35292230, 92810824, 123374148, 82482736, 40147400, 106045451, 88705203, 14914906, 74826599, 126415975, 57078849, 19251010, 97900059, 113074495, 119973630, 78674171, 121323671, 24106003, 48323715, 6168865, 74387172, 35489594, 89104706, 52418048, 37251393, 124953207, 96783994, 42914660, 98804872, 52487416, 64169871, 60033446, 40294625, 20889591, 40752330, 16458133, 113737431, 67300109, 530031, 47223473, 104621910, 111038681, 39626761, 109447117, 15952305, 109573532, 14948958, 51197605, 104413311, 2495403, 115407340, 115392115, 31636316, 38948306, 127697192, 81952300, 18375769, 128873514, 81754131, 29668892, 50625243, 33899933, 118349833, 97772618, 132015417, 58730953, 73428872, 70643338, 119717442, 39653434, 97229562, 79177668, 9099704, 68115203, 50877336, 77078423, 71731187, 39636056, 27378469, 62522297, 98053212, 31077518, 36651640, 24966471, 42669251, 52957479, 81608308, 52601977, 33074041, 5807739, 51740335, 120976093, 15262003, 99163451, 32646510, 78081841, 28153811, 71531065, 92923963, 112877908, 107452418, 65802440, 36566950, 131020258, 107902842, 91695660, 906427, 61316521, 128034471, 102743431, 70722762, 117322249, 117003209, 4853556, 8192536, 123768852, 10580420, 8928673, 63064952, 29523345, 27622036, 85521159, 65544261, 95217699, 79201368, 124741809, 21443379, 20365439, 106518337, 12491130, 113193914, 59041101, 1930449, 97374921, 17530903, 47791945, 46968313, 33554701, 62180686, 27258126, 98134284, 104697607, 74486236, 46598702, 30489665, 73303734, 46312886, 6708166, 50590029, 45806959, 94945539, 80593477, 82591064, 19755580, 10181087, 105370138, 52737239, 72363366, 91850471, 10492059, 85328325, 41196978, 44727156, 126515318, 98167326, 83606493, 58482557, 11204717, 123078428, 50667427, 23092619, 20731589, 122321981, 51860246, 13655509, 2357552, 51277254, 77972227, 122289793, 80245727, 18220982, 5913571, 71020867, 66709819, 113856307, 29381492, 21821556, 89326439, 5454383, 23015635, 123044504, 18986418, 74421224, 44845519, 22739257, 7736441, 50387394, 107336501, 59764707, 86989304, 26809994, 41018794, 114755246, 63826654, 58610668, 78139963, 90032413, 84564, 105143946, 113280610, 10892973, 30163280, 20664416, 1754506, 126668007, 123179600, 16626578, 129961984, 102063127, 107051040, 53282929, 106962130, 114142362, 5076750, 18801636, 131250028, 128072899, 127150151, 95710700, 35329188, 72366391, 128655494, 3327506, 130218561, 44149813, 39236195, 52528792, 75188474, 117483713, 110431123, 122710950, 20951233, 66673769, 12948618, 18854120, 114689345, 25484427, 73846837, 131959498, 1740774, 81628547, 97430600, 19378091, 117114893, 12208499, 49865117, 47810195, 14900954, 12146342, 55710876, 75954560, 100224195, 107579513, 45480699, 3506740, 101635543, 74425805, 44208153, 47773517, 26288867, 26193716, 37186276, 13573577, 127556040, 98126191, 92779022, 58961692, 116015961, 63756918, 120496830, 20401042, 4565208, 44461285, 15141252, 22932832, 127892913, 63475814, 80041807, 2020872, 32546483, 36592117, 7599789, 57386657, 73117516, 40723297, 105848328, 70384521, 102547723, 23378373, 69822370, 43797578, 94089485, 77719430, 111680940, 122635579, 39292353, 108715063, 91423838, 6987506, 126466520, 105931724, 89980955, 21174050, 28893608, 11800069, 91487037, 121468985, 126817970, 12716655, 33144556, 23750920, 116716242, 29310377, 91240557, 113367357, 28020399, 114745102, 85511279, 119486390, 120738465, 80953417, 37749800, 57936577, 32942673, 24916060, 67331734, 45317500, 60087205, 28784213, 29824931, 29970432, 53430505, 36799038, 131144692, 33637715, 105999006, 89928245, 49015758, 2900738, 34689918, 54044739, 46357629, 17539609, 2708740, 113664991, 40919742, 1962253, 71322214, 73655051, 110034455, 125505077, 57028795, 79085049, 57081652, 46578825, 55603220, 83307721, 103272581, 107951499, 71973572, 13833193, 9792618, 58092557, 57784187, 1452542, 97626011, 89043336, 34714106, 32245490, 117873707, 12465085, 113739749, 16843729};
        for(int i=0;i<1024;i++){
            ai.F[i]=aivalue[i];
        }

    }
    else if(i==1){
        int64_t aivalue[]={25314889, 18495606, 76655320, 103770232, 120202466, 20910366, 93673087, 47058129, 28210792, 12254160, 33326637, 67062507, 90894233, 102446158, 78738510, 19078521, 102374748, 123181178, 76925304, 27287399, 32599773, 59987878, 67355226, 16916927, 84893947, 36593338, 5217205, 100732761, 61820525, 42703755, 28324125, 59630376, 100069614, 121057279, 125686783, 46151864, 120186076, 20122535, 90570992, 47672991, 108125810, 100239086, 39258151, 28873132, 119338174, 90288568, 62174268, 28954696, 43547202, 61675222, 66908301, 119228316, 18589045, 13227008, 105459961, 128164133, 67103755, 125333492, 58564256, 37412284, 104747273, 106340961, 2218062, 113337252, 74435180, 50303383, 3492295, 41859425, 123247242, 97639085, 63353922, 23267424, 77161140, 58173915, 62979584, 28453923, 91794377, 78609782, 3629144, 68293305, 71969142, 111005603, 16842511, 7124948, 75880145, 51006548, 5311789, 121094594, 80241614, 120413053, 99845420, 112643454, 31986289, 124054086, 123493005, 24740622, 84182370, 24695488, 6510940, 116874721, 113397594, 18038910, 121135566, 58888250, 39257357, 77967735, 102788236, 47251384, 102578172, 47394569, 33105335, 34216648, 125430606, 38190886, 101436123, 41472930, 23452290, 29997230, 111166057, 63506954, 95745395, 85924749, 108620794, 44176323, 81057354, 57797363, 54440503, 55190079, 71956733, 110560476, 101519562, 85060954, 122705730, 79558989, 41997122, 89648729, 94474223, 82712694, 21565235, 12216548, 27506188, 5285755, 127223326, 69824573, 58883859, 19909654, 34195030, 126210115, 24704594, 83184954, 67011157, 7948250, 50532921, 41935280, 87401381, 104649897, 85027092, 54467061, 63754618, 125337043, 42961677, 122285835, 19223308, 22735060, 52197358, 47123359, 27601744, 48011319, 106485484, 73299177, 116859077, 80735538, 54949463, 69877703, 114170267, 76754324, 32879665, 71430549, 3507585, 60333734, 18533349, 102055531, 6872013, 39179972, 53501167, 48959230, 94341041, 17183378, 98564196, 34589293, 58136688, 124041937, 87282756, 113196709, 112147796, 77191419, 30999203, 63900732, 102885376, 62629660, 49864749, 78879777, 1768300, 28965078, 65311264, 121915523, 94990624, 47324116, 29448799, 91474971, 118820523, 49198191, 71720034, 21608433, 87673765, 42184664, 37674709, 80869759, 57243747, 57157606, 102978488, 116796542, 12749228, 21519306, 63345087, 10693013, 118151573, 126624422, 66202248, 113074013, 18885669, 89963892, 124759374, 60171092, 26802642, 90066265, 62125663, 26574213, 14329457, 855938, 24058516, 76889986, 97302636, 53879644, 78842758, 110906371, 116906772, 124916745, 103744015, 80683490, 121237628, 93566453, 126670252, 3263120, 61584334, 89728514, 48352989, 11089935, 108571319, 38474746, 110456646, 70609363, 128082296, 30875867, 39582492, 15629166, 30799247, 7184168, 19257992, 124540037, 12996049, 122182562, 88917233, 17844336, 118991133, 110546397, 61210676, 63874854, 84569755, 90056081, 117818860, 11263909, 32298236, 8514727, 46439408, 83538449, 49767240, 87408507, 52877473, 97899401, 104717522, 74646830, 117279090, 41096711, 87818580, 11497505, 53869573, 80905917, 61677522, 42992197, 63311981, 56893913, 26400367, 16285190, 99666774, 69384997, 24110350, 126078262, 73118258, 67098667, 25048058, 23923662, 57317417, 92909131, 53418620, 62567766, 38621885, 79613756, 121308184, 88085649, 128264739, 110183850, 96895364, 30979667, 73545090, 69394638, 103742582, 79878568, 86214094, 126470059, 97454085, 105585697, 100108735, 29835022, 101795888, 88735948, 56531338, 56891323, 114995186, 21518563, 5642155, 40778811, 86888030, 26392953, 4995628, 72484283, 53061249, 94928062, 129173135, 90199551, 88597875, 5392791, 19327317, 92435999, 98766869, 108133003, 48999108, 60968987, 80706003, 50459651, 111955350, 90362568, 56528659, 97452157, 43195133, 37764760, 92953089, 100997293, 85085034, 51336507, 111099536, 23376286, 19458157, 5403533, 82342018, 54995649, 106582503, 93872998, 37065417, 6437613, 28519436, 113356058, 1348122, 63342008, 29002261, 13416405, 93185773, 100004970, 130220518, 119351631, 33019042, 57180569, 31898038, 60158839, 88694873, 57028078, 42468690, 120115830, 19759141, 5067437, 124751120, 2276422, 108755593, 119799403, 26951571, 45146287, 18392630, 40926581, 23825562, 21123874, 48522005, 128736170, 95232730, 25131979, 48833273, 84454267, 55930682, 39103145, 19432835, 21157361, 28093041, 53987791, 37294655, 120557447, 89930054, 108733474, 30165646, 80114973, 31376558, 109559294, 110920740, 51368656, 60104379, 117327611, 56784550, 28579091, 16885622, 28734932, 39289053, 49300231, 73056136, 2979172, 123251320, 4031499, 29277261, 17987718, 74850560, 99623969, 9261770, 94504610, 11034879, 110206219, 51664642, 89631917, 113079652, 75991352, 17977867, 102894051, 101280539, 51692900, 63677398, 65607580, 59033689, 111180160, 95937595, 65570031, 84890907, 19194470, 21316084, 107586840, 49869606, 119841788, 71298415, 101093103, 103002610, 39140272, 27848661, 119907675, 19940320, 41496697, 84572986, 48528588, 47087700, 128516592, 124152548, 71791806, 92200485, 24303363, 102986456, 35359350, 84149615, 36215925, 26275818, 117485864, 19384893, 16986045, 3352449, 127045966, 33870709, 131691436, 112574541, 34821497, 122184037, 17608201, 25611546, 100299432, 113509283, 91816643, 81401222, 33902935, 4016439, 74484595, 60136637, 102764310, 55754917, 22812605, 5466605, 2202338, 70915836, 104808373, 50734011, 13851963, 45600971, 886854, 82444486, 131770175, 82080702, 55553877, 111202925, 70849321, 118492657, 98899521, 41622710, 48107255, 18112186, 69521998, 87968625, 124061326, 38721307, 105708357, 77175962, 24136142, 118642935, 113829750, 91789020, 74021338, 117912791, 35421110, 66993021, 126345234, 645649, 16166436, 71866692, 4760096, 84353260, 25877193, 28790937, 92197409, 118122152, 128641458, 73157571, 90732173, 68267762, 57627462, 99132196, 66864571, 25147340, 98807330, 122993724, 65627378, 39821201, 13859884, 115525186, 65399870, 130345948, 77314630, 81812824, 65508745, 7308162, 119857434, 115120551, 115142475, 32175880, 11530761, 72791459, 94631747, 43419506, 86331015, 10169954, 26585129, 22379388, 61887304, 88101400, 26415650, 110576506, 92206395, 5534411, 66523538, 69574253, 33107737, 2717612, 52516219, 78266796, 112253664, 38679048, 115243658, 88849139, 73397147, 48617252, 113762049, 115563253, 106757778, 79145755, 70035262, 87170012, 128391546, 90046677, 119789972, 116667639, 97594285, 58968777, 97312964, 4366194, 68859086, 32141735, 3842710, 52836017, 52426317, 122825976, 108382470, 99817601, 39620351, 57609879, 48346904, 42843614, 93602224, 64894499, 58986417, 65047059, 23955806, 115337751, 102312641, 116464403, 79208756, 30217730, 6462834, 128337885, 67327278, 130052568, 21289917, 90177454, 119645156, 105120316, 40488501, 23817113, 127340562, 31935124, 61914799, 64515834, 70048314, 107302566, 7832605, 130237973, 107899072, 84568087, 22112537, 73396182, 123801781, 67094022, 43889930, 90942274, 116299846, 125013278, 126645810, 131261472, 93858718, 48871901, 14818443, 105285503, 73953179, 17667103, 52479211, 8769581, 122584215, 99938932, 100420246, 75193109, 99762589, 129430849, 18467355, 7754325, 116187351, 60502795, 66813802, 47887268, 107301393, 113247380, 41209109, 2607499, 30026493, 27153380, 99209829, 21034197, 111397401, 83284335, 20857289, 11135335, 65371674, 22845744, 39818960, 21052962, 29142209, 7338323, 62571726, 82963070, 102142733, 110812041, 127498217, 4388576, 125517609, 37888182, 127040367, 66416614, 13244097, 30364222, 103200508, 37039735, 100760108, 20428958, 84826857, 110934082, 50625684, 24617387, 17267103, 126036380, 89987734, 87211552, 120978688, 84564767, 82502588, 45293787, 76238741, 72997212, 125164055, 56577175, 2263565, 115557760, 64598577, 32897856, 70553236, 26003291, 85012927, 3251790, 108205257, 75306647, 27524853, 58684077, 103548031, 27326852, 73375672, 122245142, 120635517, 55619802, 21518477, 43270950, 11919451, 115914500, 91032910, 13201674, 26362029, 31996589, 91033416, 99358122, 119521305, 38152711, 75665275, 110786446, 97883694, 95702761, 111481873, 23966776, 30711987, 60886527, 113602895, 115371686, 114731766, 128786777, 59797873, 53568095, 92681343, 52803071, 31653882, 9688526, 50884966, 24679808, 43011862, 55830426, 74016356, 108579985, 5464489, 57172364, 100049017, 6895902, 68044666, 46564657, 95292663, 26529696, 72155793, 70440234, 8619439, 4483781, 132054733, 117371977, 127460873, 104404088, 85811872, 55803482, 58780041, 9382636, 122904810, 115662024, 76802037, 122631630, 36065672, 24029269, 70811036, 47493538, 80159594, 4591428, 111487744, 73343774, 12071432, 125905863, 5232887, 65423725, 71680115, 94921894, 70245392, 84183409, 121285636, 85484784, 100019315, 125809189, 78505852, 84209424, 69303667, 44199081, 4580369, 31090586, 31057872, 15151586, 37712857, 30356602, 19928912, 15557374, 85149737, 122068371, 22590005, 98559032, 20382459, 34699927, 47379990, 115032067, 46463084, 77248428, 94271485, 15884470, 90544777, 90708087, 81997422, 26177463, 96254585, 122621557, 22239456, 98384707, 24192980, 110310389, 71416274, 95894361, 47179835, 2206564, 58138373, 4798966, 106683992, 25193434, 6232406, 66537015, 75444774, 22846913, 2699885, 3312919, 121608065, 46785617, 23668856, 115979202, 120240712, 18331917, 56690622, 112027251, 61154541, 80526885, 37595580, 53112901, 55168726, 30811167, 95147506, 52121708, 15406441, 82751171, 112667707, 79326810, 25461242, 21364330, 130696265, 52746647, 56165007, 86739801, 116250814, 19561696, 27554130, 89814136, 101135311, 80067601, 32435026, 123047416, 88165600, 77115111, 18168360, 71997317, 73680003, 126409135, 49533886, 87671660, 11738791, 109573783, 110103464, 99438746, 12280674, 109761752, 13839939, 2428404, 66565326, 98896012, 10106263, 6538169, 30494759, 48462366, 41888319, 71837766, 56419378, 71504695, 6459240, 50736304, 59220254, 115682346, 4510754, 104581363, 86530659, 118988705, 12934632, 48321575, 61601578, 27435740, 103291753, 60367849, 107036002, 122374673, 82977046, 31310033, 7990480, 96341628, 44691969, 45155385, 29894109, 58728864, 35914529, 45908491, 90753573, 123313613, 103792964, 20789151, 28778273, 36589641, 65117000, 78545806, 121120625, 40096077, 106280647, 66954261, 97593879, 44714742, 76822400, 102887510, 35324092, 114641636, 55709590, 82803728, 62794260, 74884131, 51448573, 110967598, 92205175, 12276124, 72412411, 36275293, 113854917, 110931927, 14105587, 61982431, 94517201, 117638048, 54298927, 12847396, 20342075, 69727425, 64069464, 121920354, 122552542, 29803020, 111299855, 45425848, 64419430, 21425370, 86577556};

        for(int i=0;i<1024;i++){
            ai.F[i]=aivalue[i];
        }
        
    }
    else if(i==2){
        int64_t aivalue[]={10147394, 125959266, 49468268, 91562774, 60349468, 115031684, 41936766, 125097806, 130712498, 97566419, 67116446, 120685967, 5646664, 27794957, 87730033, 29639566, 46186279, 101124738, 76556782, 24785941, 118331764, 30348846, 130489146, 123439082, 7600565, 130032360, 121276400, 32699293, 92543901, 15515713, 59380885, 18374224, 83822982, 80814003, 102626579, 116481934, 97985267, 121361448, 112031559, 131544633, 60706287, 75363494, 56316356, 84446945, 90809061, 79538178, 42235661, 104988648, 12118741, 106752210, 112508074, 4688299, 92819006, 46470833, 79068955, 15233855, 23691681, 59035906, 98354565, 47213932, 91664699, 103232090, 82908377, 44267570, 30172431, 78981583, 29104714, 77598029, 25598417, 15638527, 27261909, 57917767, 115409885, 29232197, 46035929, 14283682, 90888647, 78823825, 27040366, 46399498, 102110046, 3113911, 82509828, 90286267, 3671822, 71157098, 77070497, 3108239, 124948480, 42229342, 36581502, 22512588, 121462343, 81403667, 30557472, 1561884, 52479597, 22354398, 103299687, 56520772, 96438479, 9780140, 31048268, 87536065, 86186882, 69834048, 38825491, 101018961, 12888182, 14250338, 64901771, 40380215, 112735200, 40729347, 101902823, 31136273, 116985530, 46576050, 50779933, 5871519, 52673003, 51858083, 111559074, 9036535, 94930793, 20648582, 67550610, 65944498, 11545015, 104044996, 47887279, 439855, 16990399, 113206576, 64591032, 20046802, 21542905, 70699553, 7836355, 17336942, 122602061, 8766996, 21943778, 111219574, 53065142, 63051494, 83852265, 76506763, 126479929, 90112527, 27676565, 99251381, 93712191, 40352125, 79159364, 94607346, 34280027, 17496347, 123766390, 11280149, 66024297, 68091068, 101488756, 107209145, 14468908, 1265554, 71380992, 76203842, 47808740, 75457800, 25642425, 106727338, 125417671, 63167881, 21791733, 38097199, 57459315, 40601972, 19439116, 112940963, 129461903, 121085881, 7734487, 73421847, 105091267, 67121780, 46679537, 24248523, 102427899, 121136828, 99387771, 35216397, 54679391, 71043451, 77819570, 59224707, 58795579, 51979113, 82998121, 45648047, 18136206, 88051854, 57064341, 89042176, 64256902, 108942218, 98754745, 95454001, 74617551, 130173928, 17326145, 114802986, 2349798, 118435128, 62648461, 109545424, 107457937, 73602918, 312164, 22349577, 56071721, 81611245, 20623561, 111604033, 122911610, 127491384, 77759686, 119489211, 2047071, 32383021, 108650339, 86841909, 92690327, 110625695, 32409442, 12372324, 105152261, 31868964, 109216426, 119028223, 131827650, 77782356, 51840733, 98324189, 96303194, 22206540, 473249, 59212059, 131158892, 75334462, 97622954, 58751522, 83283283, 59669683, 106684770, 121393153, 93273457, 49456520, 59949477, 76556619, 68086675, 10349865, 30259718, 5884397, 5514662, 131927263, 82797637, 119800290, 32066944, 16421286, 1657550, 51827617, 68898233, 76562724, 56307876, 39194396, 50065150, 60571699, 114347456, 51751677, 25432754, 23843039, 115269072, 60146578, 114744640, 29493888, 41467106, 30191264, 122247608, 2504134, 18864835, 128387490, 65455491, 305085, 60682863, 67553711, 102139689, 27591584, 111230071, 38700711, 19676458, 57744309, 30937045, 20454200, 80254659, 115274233, 98412989, 116271756, 150525, 76612800, 91247375, 21428438, 64779433, 126461803, 108588623, 6798973, 126792978, 38560020, 108646757, 55400090, 16862179, 100954568, 22908461, 48392592, 78036793, 78611515, 57720577, 31243382, 36095957, 90125466, 66637636, 116757182, 76262117, 1047428, 111976362, 2281825, 14887777, 52636399, 114605904, 115000498, 124355752, 69903078, 104749616, 55507356, 45203257, 72869620, 17580297, 5488179, 76735761, 63406012, 50905318, 114535991, 35571675, 94157065, 83500727, 20419332, 31348755, 32286514, 106612694, 96139928, 36690814, 74967097, 55468943, 90759612, 13607669, 39644137, 60273611, 22290869, 106142949, 112054079, 111250131, 105802932, 129508568, 102503564, 119330505, 35540870, 29980510, 55111152, 28588201, 95409086, 100491499, 92711703, 67841364, 360294, 97780875, 38002202, 91432340, 68873854, 12844716, 12878090, 95175414, 36193012, 21649327, 62848075, 94698636, 104055035, 26457972, 68588944, 102847417, 85673376, 31689920, 80086114, 51223112, 49526593, 2207586, 79918350, 95485623, 64613371, 41523443, 58576073, 89678457, 131595857, 49826339, 41918604, 3861213, 68208303, 10755166, 106067204, 46410270, 57414955, 23562113, 110247828, 96812431, 114971062, 35360490, 73543858, 70871145, 98285910, 115695791, 111921611, 33010579, 54507877, 37794788, 125695695, 101431278, 15396229, 70240617, 45560365, 113773771, 23278686, 6777013, 22530372, 91773938, 49677001, 61470135, 9129011, 100307375, 97008495, 57546780, 97771857, 74006926, 29476396, 25899226, 52870536, 80099299, 54311031, 88358720, 100889945, 4177065, 7115318, 38578764, 23654134, 45569031, 33949967, 32124878, 37136867, 22390039, 38983454, 22274269, 28619369, 41645051, 75520523, 56357644, 20162921, 65447639, 131829412, 86051242, 33364288, 72534468, 86715764, 118780345, 82214253, 25188796, 50372730, 77338396, 90893147, 72140043, 29826464, 44441169, 40828204, 424110, 23820103, 75197062, 101480825, 15969861, 123435126, 40979836, 44275160, 93073074, 72346554, 50489372, 107743734, 53886580, 95152032, 51238234, 121382106, 83739507, 91086876, 106828149, 48743389, 125800344, 15801899, 74230701, 88417411, 128839641, 92957016, 19771576, 24480844, 69837963, 102575292, 109021082, 116685785, 34393011, 97510415, 35190945, 112225373, 9492782, 46119707, 117820960, 60305873, 43543794, 44161896, 58325429, 53771643, 72405195, 43971406, 47815269, 14772400, 34874435, 22697213, 25222534, 75362697, 73400135, 117741207, 105293535, 43068480, 19868976, 5836902, 77096547, 23883421, 60107237, 81713518, 117742533, 12669495, 78460068, 21201380, 37625568, 77072048, 121880046, 21899227, 120405143, 18121498, 51303063, 43135384, 121009192, 19504375, 109101732, 40311975, 74075535, 65995028, 79400176, 96104429, 30715987, 97724789, 75413226, 85510444, 11439110, 56379879, 53721803, 58908193, 42422669, 31058995, 70375141, 65832157, 30932730, 38959034, 94383681, 49142673, 27310382, 86285810, 22964938, 5102993, 108391553, 88831221, 22478203, 89670190, 7378153, 115144843, 120939159, 86848128, 71537068, 107139215, 40948051, 97708829, 19103125, 66970384, 56401510, 56545993, 3258242, 111940887, 8086142, 7308337, 75386766, 51794185, 36747594, 8317434, 94253828, 85398590, 1143833, 65211294, 105236876, 24216596, 91483005, 81164401, 107945928, 21208080, 110546833, 88773220, 127080555, 101808431, 24078872, 127367523, 54938242, 82875064, 38530932, 123725207, 49575392, 131802039, 51696900, 117972898, 78847378, 35444004, 70517433, 59892771, 123188801, 57132647, 75865628, 80307153, 104363895, 121287474, 42617107, 102671726, 112094875, 51981045, 106196220, 11736719, 114266515, 79052165, 117289652, 101526398, 121006573, 27941733, 50119624, 60246918, 16491571, 1727618, 120055080, 121720833, 117724594, 83621869, 93445678, 107847725, 8511015, 1737178, 50289269, 17464672, 31062270, 49590397, 105433501, 35241295, 50714386, 25492459, 33856703, 107957720, 85870087, 100024242, 27954509, 82418351, 99716582, 50579129, 21557184, 38668803, 19220917, 19689606, 125406304, 41547163, 124366095, 102217986, 44342227, 2904705, 78944128, 32183770, 128932403, 36938804, 9714199, 2706799, 3719677, 86900744, 69653234, 85070581, 26866824, 130634720, 84182414, 69620112, 102372031, 99768290, 95575746, 90980842, 107030758, 29864372, 80645609, 106238985, 7173589, 100475953, 33957541, 14047535, 111388053, 39651847, 31683621, 72859254, 34916373, 115331043, 15672929, 100901563, 46804709, 37133288, 51765976, 27934831, 60007986, 117681052, 33922990, 107303983, 119186687, 93081763, 81609775, 107991271, 127465824, 112532963, 117306121, 43884059, 116659676, 125627249, 88075144, 28371133, 28957466, 58014537, 110042036, 79037516, 2192453, 122355963, 47092086, 16865862, 118883105, 93567656, 36181256, 124840512, 6477071, 106395514, 84700903, 105073111, 88166070, 43642008, 12308359, 72923219, 67863040, 88513881, 111056370, 76225415, 94436736, 7586926, 51354612, 44565821, 52296285, 111222947, 121030263, 104582139, 58108185, 5726046, 117124507, 102812866, 66778122, 86139814, 46754032, 58998988, 87600965, 101216793, 64221045, 53961150, 45324299, 112169259, 79418924, 127799370, 9784591, 15337238, 16434631, 75746462, 18080477, 68669392, 13858706, 95618801, 5218861, 5153430, 103293632, 54706520, 130786289, 2757021, 111587806, 106835598, 9398240, 20473531, 19896190, 39212066, 92732059, 120734513, 108793512, 115405268, 64551311, 7187568, 79178158, 33324482, 121857341, 60465320, 96776605, 87978178, 54675272, 106581216, 75923015, 63595107, 88365800, 21338803, 31234967, 27703728, 1123120, 39229773, 76701853, 127304642, 49488377, 5439693, 10759077, 123553137, 67936025, 85081361, 61088055, 89755312, 78071138, 22039622, 61072124, 48383042, 43630019, 28734479, 104664949, 45689677, 3709787, 82401687, 82715708, 124782887, 104352191, 37364139, 50023752, 104160662, 26663752, 67514891, 76625970, 4199821, 39621325, 9603755, 67169695, 116054495, 28939218, 68789712, 41381344, 91558624, 71264459, 25220124, 111339465, 97324023, 56611, 83612432, 22764081, 18949236, 94605097, 6595336, 104038424, 36989687, 59714695, 47148999, 104437943, 24691153, 31779925, 56863370, 3306490, 65176925, 58853531, 36712504, 34803000, 33927579, 49534281, 61903323, 81479323, 83592227, 89719567, 85399032, 17672536, 46400390, 22802053, 31205884, 21881390, 60693885, 4181125, 93423608, 50937138, 69329087, 79538194, 32297118, 120037425, 1986847, 122026834, 23852883, 60571269, 116789887, 41941930, 108879119, 7777684, 60062653, 99086549, 46143037, 7374233, 66841026, 34284957, 82901218, 70834578, 112112989, 90660867, 116992531, 26768053, 93179487, 31743906, 102225650, 56906869, 124570103, 99972413, 69547887, 37188668, 62336385, 118698226, 82192391, 22578873, 60625105, 105545399, 89940437, 38420639, 75933432, 99988045, 71680766, 48986018, 42020761, 45841227, 129363655, 42051201, 63641909, 40165328, 42755762, 12895192, 51404687, 68652553, 99747442, 111734533, 106556314, 121146313, 37699958, 1077489, 72029586, 39049073, 98862059, 24958279, 86243098, 119861921, 67220736, 14141838, 47530163, 21845973, 38511699, 101459028, 90724963, 55284458, 106324114, 25800894, 7351020, 100488716, 26247740, 64819013, 54604497, 20819830, 121975320, 106255106, 92439923, 93775680, 88462457, 65916233, 70670657, 73354413, 40436847, 65862174, 18261854, 24110214, 82650809, 73880463, 19146175, 102751650, 17365148, 106091666, 42467054, 110403409, 130121745};

        for(int i=0;i<1024;i++){
            ai.F[i]=aivalue[i];
        }

    }
    else {
        int64_t aivalue[]={62660984, 105868049, 59138273, 927798, 111772396, 105976469, 43487360, 80666971, 128000150, 4948536, 13879215, 95884184, 12243657, 124685239, 32376047, 69794992, 10612010, 131447597, 14188978, 119717849, 95718725, 110995354, 42370014, 27748213, 43224213, 128047755, 123854265, 71038024, 113119363, 80515802, 76432529, 46227489, 50724145, 91486334, 74392119, 23402679, 117203650, 54954432, 89863206, 83043983, 2620781, 37689136, 122385813, 81735194, 57256888, 114616789, 66969203, 115204165, 64830160, 51496978, 115159585, 75471171, 55992456, 114994303, 13863760, 118052544, 7629171, 32424573, 40272982, 6115847, 10551382, 21307243, 73748007, 82018388, 123959053, 45126295, 32197468, 131366506, 66519829, 7874825, 123466272, 35623380, 81412848, 12326710, 84665183, 126510917, 49516413, 74865381, 34526975, 31976639, 102129101, 68207418, 502530, 75520253, 95928662, 29818255, 27321779, 14004425, 12727508, 56500535, 87254558, 44225172, 25124903, 113878967, 81466117, 117208046, 29346253, 128393331, 123333052, 129337296, 91520881, 130669463, 82464065, 57069032, 2759074, 84304960, 98980194, 84415216, 18802961, 31830635, 116026617, 91050116, 73924024, 12000607, 95659622, 35034218, 122692474, 114281474, 108890341, 116123415, 47743180, 28147882, 27184695, 50142739, 35102108, 94211354, 14344088, 74086175, 24695719, 85494750, 82606773, 11116099, 31493704, 86273508, 68488803, 78687612, 113845929, 48593126, 122052581, 21940686, 49431235, 42371314, 94019388, 113317359, 1990908, 107674963, 84386948, 96585068, 108959154, 92191801, 86224091, 7927420, 23055011, 111539255, 14560576, 18198786, 70573428, 79238778, 47654751, 114588866, 77425642, 55410102, 92999283, 45217723, 5627487, 132078584, 16190744, 66260848, 83437829, 64518802, 52612974, 31245126, 10184636, 93665509, 48770113, 2178568, 45191941, 2651110, 121653868, 73681044, 104234394, 128516634, 41744228, 102497869, 93235616, 133577, 105072202, 76368419, 130194601, 2119092, 29303931, 15618231, 130137986, 113683890, 6984538, 56483844, 61432436, 88174687, 111602732, 11685463, 73920041, 44885612, 120066613, 17568027, 58414432, 30454090, 11115315, 11889592, 126284506, 120452272, 50700292, 41204775, 30029775, 57442708, 34608449, 60298686, 101230078, 63015064, 88225522, 10107614, 111313756, 86804415, 110838094, 13488987, 7667483, 56084862, 562553, 61991025, 16515517, 53596606, 83090908, 124430845, 23075342, 36613867, 112806162, 87798339, 55215892, 59100935, 36623273, 76004808, 104203213, 2386433, 73192029, 103779409, 15852683, 23762158, 15533811, 120078585, 84927878, 69135997, 101024992, 75282938, 85803477, 88377334, 95384024, 62412019, 83287739, 10012624, 92662444, 106396493, 53356961, 29322708, 118273133, 18821691, 35102477, 86817407, 58216192, 14766238, 52158814, 73326651, 86214059, 36365094, 41998346, 100639521, 106139411, 50714436, 73775562, 92032620, 88249900, 126374503, 40934757, 7438381, 17330833, 27765698, 106763415, 110661657, 3101056, 83187758, 100500047, 32287322, 121074598, 65941585, 74364042, 35030245, 23134989, 105262001, 3816727, 98529275, 100788666, 40431680, 30450846, 106178291, 103342592, 40058671, 109387537, 64956566, 81651537, 67697915, 25456970, 48727701, 120939255, 55796344, 17327038, 70251652, 5990593, 56994289, 16398093, 6197230, 62761316, 100950466, 104022078, 56568577, 32359134, 108129044, 110122443, 113963924, 20191876, 24798595, 90758695, 117157864, 122929881, 14851545, 67109606, 96919027, 108967189, 46796056, 83306742, 5594284, 115140994, 46616066, 67238140, 123060112, 113842219, 127947661, 87554469, 4484986, 59135311, 27294420, 27470327, 67193932, 12990513, 127177330, 103764123, 130415745, 120824604, 49502930, 864796, 22555744, 114481510, 26782434, 16052955, 47216828, 96105904, 64575408, 104015286, 43925034, 11888749, 40934820, 64967648, 83339547, 131073776, 73413514, 110281051, 25492112, 91594114, 68773609, 123307920, 99299256, 130220778, 28286331, 101225664, 42699694, 122502731, 115152401, 15265446, 11419584, 20699399, 47728705, 87004386, 64551022, 105644091, 97670183, 44122459, 11045828, 42885540, 5411848, 106943231, 32970499, 131334439, 98278210, 78514044, 31779745, 103917848, 110183409, 100048341, 20287710, 31590217, 90940912, 39715524, 19675224, 33391540, 120884428, 31425380, 24141382, 13462222, 84343071, 78736519, 119066177, 39000719, 62029217, 71837556, 73487467, 83899131, 77078399, 25092456, 117407040, 101346330, 61503195, 93011158, 7944598, 61643446, 124400347, 90298499, 60893031, 72060534, 89836360, 100990763, 128467466, 72841503, 84585255, 20391512, 97451065, 51957692, 46340263, 106436157, 56892049, 125994672, 19503651, 39574920, 13565338, 13367174, 39350211, 50847443, 99908820, 128713792, 106947, 122427890, 49246518, 35572755, 32519894, 51759857, 93336269, 42697794, 109154351, 74279183, 10300651, 26189079, 49037951, 23407990, 57538552, 60356767, 82745882, 69905773, 44123234, 117743904, 67214434, 132120189, 85591497, 60127993, 39541605, 26827892, 43811159, 113539438, 47860310, 100368599, 97242546, 68601463, 10409429, 87441662, 97291181, 12524571, 42317481, 63238510, 58828804, 114638681, 38483894, 89455314, 16708614, 23488348, 92737143, 128556776, 85841533, 43761970, 20536928, 120587885, 118135334, 38208453, 119497777, 18951284, 21741217, 126781955, 67237976, 75935179, 20244057, 69930528, 53738660, 51747149, 53180404, 36678514, 66443739, 19335445, 86127953, 79666280, 23670946, 5512405, 69966281, 12278168, 7139408, 35932319, 76000969, 117223888, 98172988, 71978665, 13973747, 31987644, 794373, 77985639, 89458914, 110456567, 56050698, 91001245, 71617574, 81539079, 69343534, 75656178, 101455651, 55406200, 109583714, 54555904, 41939082, 87807705, 6570978, 118451027, 36526493, 38270580, 17714875, 41752574, 88527214, 79452716, 35814969, 41114076, 102830938, 6226622, 36367561, 54260302, 74023767, 116749562, 10970178, 105831914, 129898375, 120300378, 87117402, 44172275, 120077430, 97375571, 66437963, 122810383, 103957077, 101061298, 78457098, 53010355, 374839, 17293232, 67158063, 106168343, 76531695, 80301547, 93268419, 37423608, 95626923, 81173942, 23885372, 81895502, 92599930, 116738255, 122642033, 47124165, 103190174, 125439599, 105181375, 31612639, 116068863, 41618624, 83273394, 82990202, 70089767, 77211978, 43488707, 115590657, 20745902, 23127134, 56548161, 36109410, 33669067, 114977017, 112283467, 18118572, 59278843, 65654082, 80641433, 130555277, 7012627, 116365653, 92951501, 24128407, 103570952, 118050156, 41233905, 21895051, 69406806, 30478705, 50950318, 32081539, 24672261, 23366288, 110147015, 4904972, 36431697, 74447317, 98148728, 108187434, 127594079, 94168729, 107740546, 46467995, 27953443, 40883753, 27442684, 121554991, 31371605, 87567927, 81038990, 54254107, 93501462, 86091089, 81712648, 20125953, 124629974, 41228649, 72555059, 58945061, 83598592, 117843410, 104527528, 43865053, 124686130, 106900926, 82342866, 14356088, 47280236, 126949106, 106503277, 127721175, 112384385, 79208211, 31869371, 31845922, 131545431, 44998542, 70101753, 16248046, 59439080, 10841205, 13926897, 112189691, 13269646, 117538258, 104792342, 47814219, 56661658, 46919605, 117914626, 41930512, 2222669, 80764197, 61588740, 16403840, 113338980, 104996389, 44162167, 103272312, 17100944, 58132127, 357074, 37057731, 30261471, 3491787, 16447470, 103976141, 101910353, 46478543, 130999895, 97811315, 101901998, 105331869, 105007209, 109866167, 30452533, 70556331, 38507212, 99126736, 22028259, 59822929, 71599382, 3322266, 7269741, 24861839, 24506736, 109920171, 90506665, 104324563, 111575694, 40240142, 51145427, 127506060, 48064175, 77726702, 112903989, 4791279, 104839373, 73986067, 56902287, 77586387, 81704030, 11618156, 61289444, 126740977, 23754207, 11993118, 114082584, 103166158, 23354682, 124062373, 100532532, 119451190, 11559365, 54143669, 9113004, 107879710, 33291787, 78224087, 104294788, 126848740, 106219195, 66653644, 31170418, 102507952, 119939364, 114610098, 82164406, 6753156, 34758059, 94728837, 21172589, 82684923, 105569923, 42381829, 100050087, 61572781, 29275941, 55930524, 97215841, 112143314, 80828187, 123008429, 7957310, 71724434, 128926873, 73099683, 47869889, 20497378, 20815083, 224960, 82632334, 18226189, 112270307, 82680037, 29560351, 11965290, 116841824, 89213237, 101396707, 12284814, 128139092, 6379268, 37254957, 61493988, 75437608, 33683448, 119920565, 124444949, 67013293, 58759508, 96985683, 47190924, 101900514, 34783695, 89072994, 84177807, 107442932, 93113282, 30749519, 6572942, 90073986, 64838949, 60274036, 97870376, 111604243, 4363382, 106384353, 22466729, 78085838, 79443656, 84910048, 286202, 92492350, 21891185, 66217978, 107434723, 91523081, 2347616, 11318312, 37095081, 119267112, 43739176, 97938307, 86018140, 97759930, 79742810, 23779380, 57366689, 37537462, 116774133, 124962114, 43139163, 94131000, 117549987, 685377, 76312488, 57129038, 98653003, 45113242, 124958795, 99092625, 77417619, 32836726, 24283037, 69468888, 106200426, 18275244, 66812506, 43164913, 2659761, 53161373, 100130473, 81967230, 84229239, 119214247, 78357246, 71815722, 4177635, 118791888, 79845534, 130594163, 103582789, 78195032, 11227300, 124365136, 42934731, 11012546, 61849380, 61136734, 92000499, 16364981, 25619159, 54096738, 14173337, 105529307, 17856243, 39973092, 51788020, 23943896, 71699095, 40227450, 13256295, 14473100, 8498368, 95246969, 45906265, 68733050, 117932134, 35668097, 51068831, 131674003, 37759551, 114110539, 105215812, 129768060, 210762, 113507326, 89911264, 67438173, 104161405, 98489981, 95515820, 71819668, 117054508, 44617925, 43791399, 11820336, 11083110, 9393098, 4632819, 12525395, 97506460, 20719224, 102689824, 52612854, 65040862, 90774214, 80519799, 76142860, 46152592, 62346230, 103621161, 48157876, 80998946, 84368991, 47784319, 81705248, 109574625, 51378211, 91286751, 11160392, 129579955, 18059879, 128643701, 58507128, 13511832, 117000909, 54494339, 24453303, 18002721, 49183138, 5617808, 43233049, 20758041, 33882370, 19193381, 1575543, 534275, 125512816, 8348224, 6842956, 129894625, 121480152, 15965275, 66391997, 110193148, 76366870, 42794225, 114663196, 97383150, 99190538, 98014196, 102297511, 43551312, 86925612, 111416311, 91362478, 128909455, 105572168, 39634649, 49096031, 21205404, 67504436, 79118209, 58155971, 50262846, 93388761, 123149685, 78804120, 60789632, 33278993, 16298949, 129489299, 69694555, 23609299, 101809922, 98210600, 87434023, 64713350, 101073689, 128632618, 28934937, 70226286, 22028145, 58955078, 78266584, 123510772, 50711408, 27398756, 25687472, 64735340};

        for(int i=0;i<1024;i++){
            ai.F[i]=aivalue[i];
        }
    }
    for (uint64_t j = 0; j < bfv->n; j++) {
      Ts2.F[j] = pos_mod((modpow(bfv->T, i, bfv->q) * sk2.F[j]) , bfv->q);
    }
    poly_mul(&ai, &bfv->sk, &bfv->rlk1[i][0]);

    poly_neg(&bfv->rlk1[i][0], &bfv->rlk1[i][0]);

    poly_add(&Ts2, &bfv->rlk1[i][0], &bfv->rlk1[i][0]);

    poly_sub(&bfv->rlk1[i][0], &ei, &bfv->rlk1[i][0]);
    poly_init(&bfv->rlk1[i][1], bfv->n, bfv->q, bfv->qnp);
    for (uint64_t j = 0; j < bfv->n; j++) {
      bfv->rlk1[i][1].F[j] = ai.F[j];
    }
  }
}

void bfv_encryption(BFV *bfv, Poly *m, Poly *ct) {
  int64_t delta = (int64_t)floor12((double)bfv->q / bfv->t);
  Poly u, e1, e2, md;
  poly_init(&u, bfv->n, bfv->q, bfv->qnp);
  poly_init(&e1, bfv->n, bfv->q, bfv->qnp);
  poly_init(&e2, bfv->n, bfv->q, bfv->qnp);
  poly_init(&md, bfv->n, bfv->q, bfv->qnp);
//   poly_randomize(&u, 2, 0, 0, 0, 0);
//   poly_randomize(&e1, 0, 0, 1, bfv->mu, bfv->sigma);
//   poly_randomize(&e2, 0, 0, 1, bfv->mu, bfv->sigma);
    int64_t uvalue[]={1, 132120576, 1, 132120576, 132120576, 1, 1, 132120576, 132120576, 1, 0, 1, 1, 1, 0, 132120576, 132120576, 132120576, 1, 0, 132120576, 132120576, 132120576, 1, 1, 1, 132120576, 0, 132120576, 132120576, 0, 1, 132120576, 0, 132120576, 1, 1, 0, 1, 1, 0, 132120576, 0, 0, 132120576, 1, 1, 132120576, 132120576, 1, 132120576, 0, 0, 132120576, 1, 1, 1, 0, 1, 132120576, 0, 0, 132120576, 0, 1, 1, 1, 1, 132120576, 0, 1, 132120576, 0, 132120576, 1, 132120576, 1, 1, 0, 1, 132120576, 0, 132120576, 0, 0, 132120576, 132120576, 1, 1, 0, 132120576, 1, 1, 1, 1, 0, 0, 1, 0, 132120576, 132120576, 0, 132120576, 0, 0, 132120576, 1, 0, 132120576, 0, 0, 1, 132120576, 0, 0, 1, 0, 1, 1, 0, 132120576, 132120576, 0, 0, 132120576, 1, 0, 132120576, 1, 132120576, 1, 1, 132120576, 1, 1, 0, 1, 0, 0, 1, 132120576, 1, 0, 132120576, 132120576, 0, 132120576, 132120576, 0, 132120576, 0, 0, 0, 0, 132120576, 132120576, 132120576, 1, 1, 1, 1, 1, 1, 132120576, 132120576, 0, 1, 1, 132120576, 132120576, 0, 132120576, 0, 0, 1, 0, 132120576, 1, 132120576, 0, 1, 0, 1, 132120576, 132120576, 132120576, 0, 0, 0, 1, 1, 0, 0, 0, 132120576, 0, 132120576, 1, 132120576, 132120576, 0, 0, 0, 132120576, 1, 0, 1, 1, 0, 132120576, 132120576, 0, 0, 0, 1, 1, 132120576, 0, 0, 0, 132120576, 0, 1, 0, 0, 132120576, 1, 1, 132120576, 132120576, 132120576, 1, 1, 132120576, 132120576, 132120576, 0, 0, 132120576, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 132120576, 1, 1, 132120576, 1, 1, 132120576, 1, 0, 0, 1, 1, 132120576, 132120576, 1, 0, 1, 132120576, 132120576, 0, 132120576, 132120576, 132120576, 132120576, 0, 1, 132120576, 1, 1, 132120576, 132120576, 0, 132120576, 1, 1, 0, 0, 1, 1, 132120576, 0, 132120576, 0, 132120576, 1, 132120576, 132120576, 132120576, 132120576, 1, 132120576, 0, 1, 0, 132120576, 0, 1, 132120576, 1, 1, 1, 1, 0, 132120576, 1, 132120576, 1, 0, 132120576, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 132120576, 132120576, 0, 132120576, 132120576, 1, 1, 132120576, 132120576, 1, 132120576, 132120576, 0, 1, 1, 1, 1, 132120576, 1, 1, 1, 132120576, 1, 0, 1, 0, 1, 132120576, 0, 1, 132120576, 132120576, 1, 0, 0, 1, 0, 132120576, 132120576, 1, 132120576, 1, 132120576, 1, 0, 1, 0, 0, 132120576, 132120576, 132120576, 132120576, 132120576, 1, 132120576, 0, 132120576, 0, 0, 1, 1, 0, 0, 1, 132120576, 132120576, 0, 132120576, 0, 132120576, 132120576, 1, 0, 0, 132120576, 0, 132120576, 0, 0, 132120576, 0, 132120576, 0, 132120576, 1, 1, 1, 1, 132120576, 1, 132120576, 1, 0, 0, 132120576, 0, 0, 1, 0, 132120576, 132120576, 0, 1, 0, 132120576, 132120576, 1, 0, 132120576, 0, 0, 0, 0, 132120576, 1, 0, 0, 1, 132120576, 0, 0, 132120576, 132120576, 1, 132120576, 1, 0, 1, 132120576, 0, 132120576, 1, 0, 132120576, 1, 0, 1, 0, 0, 1, 0, 132120576, 1, 0, 132120576, 1, 1, 1, 0, 1, 1, 1, 0, 0, 132120576, 132120576, 0, 132120576, 132120576, 1, 132120576, 0, 1, 132120576, 0, 132120576, 1, 0, 0, 132120576, 1, 132120576, 0, 0, 132120576, 1, 0, 132120576, 0, 0, 132120576, 0, 0, 1, 0, 0, 0, 132120576, 132120576, 132120576, 0, 0, 132120576, 132120576, 0, 132120576, 132120576, 132120576, 1, 0, 1, 0, 132120576, 1, 0, 1, 0, 132120576, 0, 0, 132120576, 132120576, 0, 132120576, 0, 1, 132120576, 0, 0, 132120576, 132120576, 132120576, 0, 1, 1, 1, 0, 1, 132120576, 1, 132120576, 1, 1, 0, 1, 1, 132120576, 1, 1, 0, 1, 1, 132120576, 1, 132120576, 132120576, 1, 132120576, 1, 0, 1, 132120576, 132120576, 0, 0, 1, 1, 132120576, 132120576, 1, 132120576, 1, 0, 0, 1, 132120576, 0, 132120576, 0, 0, 1, 0, 1, 132120576, 1, 0, 0, 1, 1, 132120576, 1, 1, 132120576, 0, 1, 1, 1, 0, 0, 0, 0, 1, 132120576, 0, 0, 0, 0, 132120576, 132120576, 132120576, 1, 1, 0, 132120576, 0, 0, 1, 132120576, 0, 1, 1, 0, 0, 132120576, 0, 0, 132120576, 132120576, 1, 1, 0, 1, 0, 0, 0, 132120576, 0, 1, 132120576, 132120576, 132120576, 132120576, 1, 0, 132120576, 0, 1, 132120576, 132120576, 0, 0, 1, 132120576, 132120576, 132120576, 0, 132120576, 132120576, 0, 132120576, 132120576, 132120576, 132120576, 132120576, 0, 1, 0, 0, 132120576, 0, 0, 1, 1, 132120576, 1, 0, 132120576, 132120576, 132120576, 132120576, 132120576, 1, 0, 1, 132120576, 132120576, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 132120576, 132120576, 132120576, 0, 1, 0, 132120576, 132120576, 132120576, 1, 0, 0, 0, 1, 1, 132120576, 0, 1, 1, 0, 0, 132120576, 0, 132120576, 1, 1, 132120576, 1, 132120576, 1, 132120576, 132120576, 132120576, 1, 0, 132120576, 1, 132120576, 0, 0, 0, 0, 0, 0, 132120576, 132120576, 0, 132120576, 0, 132120576, 1, 132120576, 132120576, 0, 1, 132120576, 1, 132120576, 132120576, 0, 132120576, 0, 1, 1, 0, 1, 0, 0, 0, 132120576, 0, 1, 132120576, 132120576, 1, 132120576, 1, 1, 132120576, 1, 132120576, 1, 132120576, 132120576, 132120576, 0, 1, 0, 0, 0, 0, 132120576, 0, 0, 1, 0, 132120576, 132120576, 132120576, 0, 0, 0, 1, 132120576, 132120576, 1, 132120576, 0, 0, 132120576, 1, 132120576, 132120576, 132120576, 0, 0, 0, 132120576, 132120576, 0, 0, 1, 132120576, 0, 1, 132120576, 132120576, 132120576, 0, 132120576, 0, 0, 1, 1, 132120576, 1, 1, 132120576, 132120576, 1, 132120576, 1, 1, 1, 132120576, 1, 132120576, 132120576, 0, 0, 132120576, 1, 1, 0, 1, 0, 1, 132120576, 1, 1, 1, 1, 1, 0, 132120576, 1, 132120576, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 132120576, 0, 0, 132120576, 132120576, 0, 132120576, 0, 0, 132120576, 1, 132120576, 132120576, 132120576, 132120576, 1, 0, 132120576, 132120576, 0, 1, 132120576, 0, 0, 1, 132120576, 0, 1, 0, 1, 1, 1, 0, 132120576, 0, 0, 1, 132120576, 1, 132120576, 0, 1, 132120576, 1, 1, 0, 132120576, 1, 1, 132120576, 132120576, 132120576, 1, 0, 1, 132120576, 0, 1, 1, 0, 132120576, 0, 1, 132120576, 1, 0, 132120576, 1, 0, 0, 1, 0, 0, 132120576, 132120576, 0, 0, 1, 1, 0, 0, 0, 1, 132120576, 1, 0, 132120576, 1, 1, 132120576, 0, 0, 1, 132120576, 0, 1, 0, 0, 1, 0, 0, 132120576, 0, 132120576, 1, 132120576, 0, 132120576, 0, 1, 132120576, 132120576, 0, 0, 0, 0, 1, 1, 1, 132120576, 132120576, 132120576, 0};
   
    for(int i=0;i<1024;i++){
            u.F[i]=uvalue[i];
    }

  for (uint64_t i = 0; i < bfv->n; i++) {
    md.F[i] = pos_mod((delta * m->F[i]), bfv->q);
  }
  poly_mul(&bfv->pk[0], &u, &ct[0]);
  poly_add(&ct[0], &e1, &ct[0]);
  poly_add(&ct[0], &md, &ct[0]);
  poly_mul(&bfv->pk[1], &u, &ct[1]);
  poly_add(&ct[1], &e2, &ct[1]);

}

void bfv_decryption(BFV *bfv, Poly *ct, Poly *m) {
  Poly temp;
  poly_init(&temp, bfv->n, bfv->q, bfv->qnp);

  poly_mul(&ct[1], &bfv->sk, &temp);

  poly_add(&temp, &ct[0], m);

  for (uint64_t i = 0; i < bfv->n; i++) {
    m->F[i] = (int64_t)python_round((double)bfv->t * m->F[i] / bfv->q);
  }

  poly_mod(m, bfv->t, m);

}

void bfv_relinearization_v1(BFV *bfv, Poly *ct, Poly *ctr) {
  Poly c0, c1, c2;
  poly_init(&c0, bfv->n, bfv->q, bfv->qnp);
  poly_init(&c1, bfv->n, bfv->q, bfv->qnp);
  poly_init(&c2, bfv->n, bfv->q, bfv->qnp);
  for (uint64_t i = 0; i < bfv->n; i++) {
    c0.F[i] = ct[0].F[i];
    c1.F[i] = ct[1].F[i];
    c2.F[i] = ct[2].F[i];
  }

  Poly c2i[4], c2q, c2r;
  poly_init(&c2q, bfv->n, bfv->q, bfv->qnp);
  for (uint64_t i = 0; i < bfv->n; i++) {
    c2q.F[i] = c2.F[i];
  }

  for (int64_t i = 0; i <= bfv->l; i++) {
    poly_init(&c2i[i], bfv->n, bfv->q, bfv->qnp);
    poly_init(&c2r, bfv->n, bfv->q, bfv->qnp);
    for (uint64_t j = 0; j < bfv->n; j++) {
      int64_t qt = c2q.F[j] / bfv->T;

      int64_t rt = c2q.F[j] - qt * bfv->T;

      c2q.F[j] = qt;
      c2r.F[j] = rt;
    }
    for (uint64_t j = 0; j < bfv->n; j++) {
      c2i[i].F[j] = c2r.F[j];
    }
  }
  Poly c0r, c1r;
  poly_init(&c0r, bfv->n, bfv->q, bfv->qnp);
  poly_init(&c1r, bfv->n, bfv->q, bfv->qnp);
  for (uint64_t i = 0; i < bfv->n; i++) {
    c0r.F[i] = c0.F[i];
    c1r.F[i] = c1.F[i];
  }

  for (int64_t i = 0; i <= bfv->l; i++) {
    Poly temp;
    poly_init(&temp, bfv->n, bfv->q, bfv->qnp);
    poly_mul(&bfv->rlk1[i][0], &c2i[i], &temp);
    poly_add(&c0r, &temp, &c0r);
    poly_mul(&bfv->rlk1[i][1], &c2i[i], &temp);
    poly_add(&c1r, &temp, &c1r);
  }
  for (uint64_t i = 0; i < bfv->n; i++) {
    ctr[0].F[i] = c0r.F[i];
    ctr[1].F[i] = c1r.F[i];
  }
}

void bfv_int_encode(BFV *bfv, int64_t m, Poly *mr) {
  if (m >= 0) {
    for (uint64_t i = 0; i < bfv->n; i++) {
      mr->F[i] = pos_mod(m,2);
      m /= 2;
    }
  } else {
    m = -m;
    for (uint64_t i = 0; i < bfv->n; i++) {
      mr->F[i] = pos_mod((bfv->t - pos_mod(m,2)), bfv->t);
      m /= 2;
    }
  }
}

int64_t bfv_int_decode(BFV *bfv, Poly *m) {
  int64_t mr = 0;
  int64_t thr_ = (bfv->t == 2) ? 2 : ((bfv->t + 1) >> 1);
  for (uint64_t i = 0; i < bfv->n; i++) {
    int64_t c = m->F[i];
    int64_t c_ = (c >= thr_) ? -(bfv->t - c) : c;
    
    mr += c_ * (int64_t)(1 << i);
  }

  return mr;
}

void bfv_homomorphic_addition(BFV *bfv, Poly *ct0, Poly *ct1, Poly *ct_add) {
  poly_add(&ct0[0], &ct1[0], &ct_add[0]);
  poly_add(&ct0[1], &ct1[1], &ct_add[1]);
}

void bfv_homomorphic_subtraction(BFV *bfv, Poly *ct0, Poly *ct1, Poly *ct_sub) {
  poly_sub(&ct0[0], &ct1[0], &ct_sub[0]);
  poly_sub(&ct0[1], &ct1[1], &ct_sub[1]);
}

void bfv_homomorphic_multiplication(BFV *bfv, Poly *ct0, Poly *ct1, Poly *ct_mul) {
  Poly ct00, ct01, ct10, ct11;
  poly_init(&ct00, bfv->n, bfv->q, bfv->qnp);
  poly_init(&ct01, bfv->n, bfv->q, bfv->qnp);
  poly_init(&ct10, bfv->n, bfv->q, bfv->qnp);
  poly_init(&ct11, bfv->n, bfv->q, bfv->qnp);
  for (uint64_t i = 0; i < bfv->n; i++) {
    ct00.F[i] = ct0[0].F[i];
    ct01.F[i] = ct0[1].F[i];
    ct10.F[i] = ct1[0].F[i];
    ct11.F[i] = ct1[1].F[i];
  }

  int64_t r0[bfv->n], r1[bfv->n], r2[bfv->n], r3[bfv->n];
  int64_t a0[bfv->n], a1[bfv->n], a2[bfv->n], a3[bfv->n];
  RefPolMulv2(ct00.F, ct10.F, a0, r0);

  RefPolMulv2(ct00.F, ct11.F, a1, r1);

  RefPolMulv2(ct01.F, ct10.F, a2, r2);
  RefPolMulv2(ct01.F, ct11.F, a3, r3);

  for (uint64_t i = 0; i < bfv->n; i++) {
    ct_mul[0].F[i] = r0[i];
    ct_mul[1].F[i] = (r1[i] + r2[i]);
    ct_mul[2].F[i] = r3[i];
  }

for (uint64_t i = 0; i < bfv->n; i++) {
    long double temp_ct_mul_0 = ((long double)bfv->t * ct_mul[0].F[i] / bfv->q);
    long double temp_ct_mul_1 = ((long double)bfv->t * ct_mul[1].F[i] / bfv->q);
    long double temp_ct_mul_2 = ((long double)bfv->t * ct_mul[2].F[i] / bfv->q);

    ct_mul[0].F[i] = (int64_t)python_round(temp_ct_mul_0);
    ct_mul[1].F[i] = (int64_t)python_round(temp_ct_mul_1);
    ct_mul[2].F[i] = (int64_t)python_round(temp_ct_mul_2);
}

  for (uint64_t i = 0; i < bfv->n; i++) {
    ct_mul[0].F[i] = pos_mod(python_round(ct_mul[0].F[i]), bfv->q);
    ct_mul[1].F[i] = pos_mod(python_round(ct_mul[1].F[i]), bfv->q);
    ct_mul[2].F[i] = pos_mod(python_round(ct_mul[2].F[i]), bfv->q);
  }

}

int main() {
  int64_t t = 16, n = 1024, q = 132120577, psi = 73993;
  int64_t psiv = modinv(psi, q), w = modpow(psi, 2, q), wv = modinv(w, q);
  int64_t mu = 0, sigma = 1;
  int64_t T = 256;
  int64_t w_table[n], wv_table[n], psi_table[n], psiv_table[n];
  for (uint64_t i = 0; i < n; i++) {
    w_table[i] = 1;
    wv_table[i] = 1;
    psi_table[i] = 1;
    psiv_table[i] = 1;
    
  }

  for (uint64_t i = 1; i < n; i++) {
    w_table[i] = pos_mod((w_table[i - 1] * w) , q);
    wv_table[i] = pos_mod((wv_table[i - 1] * wv) , q);
    psi_table[i] = pos_mod((psi_table[i - 1] * psi) , q);
    psiv_table[i] = pos_mod((psiv_table[i - 1] * psiv) , q);
    
  }

int64_t qnp[4 * n];
    for (uint64_t i = 0; i < n; i++) {
        qnp[i] = w_table[i];
        qnp[n + i] = wv_table[i];
        qnp[2 * n + i] = psi_table[i];
        qnp[3 * n + i] = psiv_table[i];
    }
  printf("--- Starting BFV Demo\n");
  BFV bfv;
  bfv_init(&bfv, n, q, t, mu, sigma, qnp);
  bfv_secret_key_gen(&bfv);

  bfv_public_key_gen(&bfv);
  bfv_eval_key_gen_v1(&bfv, T);

  int64_t n1 = -42343, n2 = 42323;
  printf("* n1: %lld\n", n1);
  printf("* n2: %lld\n", n2);
  printf("* n1*n2: %lld\n", n1 * n2);
  Poly m1, m2;
  poly_init(&m1, n, t, qnp);
  poly_init(&m2, n, t, qnp);
  bfv_int_encode(&bfv, n1, &m1);
  bfv_int_encode(&bfv, n2, &m2);

  Poly ct1[2], ct2[2];
  for (int i = 0; i < 2; i++) {
    poly_init(&ct1[i], n, q, qnp);
    poly_init(&ct2[i], n, q, qnp);
  }

  bfv_encryption(&bfv, &m1, ct1);
  bfv_encryption(&bfv, &m2, ct2);

  Poly ct_mul[3], ct[2];
  for (int i = 0; i < 3; i++) {
    poly_init(&ct_mul[i], n, q, qnp);
  }
  for (int i = 0; i < 2; i++) {
    poly_init(&ct[i], n, q, qnp);
  }
  bfv_homomorphic_multiplication(&bfv, ct1, ct2, ct_mul);

  bfv_relinearization_v1(&bfv, ct_mul, ct);

  Poly mt;
  poly_init(&mt, n, t, qnp);
  bfv_decryption(&bfv, ct, &mt);

printf("\n");
  int64_t nr = bfv_int_decode(&bfv, &mt);
  int64_t ne = n1 * n2;
  if (nr == ne) {
    printf("* Decoded value %lld\n",nr);
    printf("* Homomorphic multiplication works.\n");
  } else {
    printf("* Homomorphic multiplication does not work. %lld\n",nr);
  }

  
  
 
  return 0;
} 
